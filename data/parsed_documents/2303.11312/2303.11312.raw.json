{
  "title": "waywiser: Ergonomic Methods for Assessing Spatial Models",
  "authors": [
    "Michael J Mahoney"
  ],
  "source_path": "../data/pdf/2303.11312.pdf",
  "page_count": 29,
  "processed_pages": [
    1,
    2,
    3,
    4,
    5,
    6,
    7,
    8,
    9,
    10,
    11,
    12,
    13,
    14,
    15,
    16,
    17,
    18,
    19,
    20,
    21,
    22,
    23,
    24,
    25,
    26,
    27,
    28,
    29
  ],
  "counts": {
    "texts": 404,
    "pictures": 4,
    "tables": 38
  },
  "stats_per_page": [
    {
      "page": 1,
      "text_blocks": 9,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 2
    },
    {
      "page": 2,
      "text_blocks": 8,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 3,
      "text_blocks": 12,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 4,
      "text_blocks": 24,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 5,
      "text_blocks": 38,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 6,
      "text_blocks": 25,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 7,
      "text_blocks": 11,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 8,
      "text_blocks": 6,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 2
    },
    {
      "page": 9,
      "text_blocks": 7,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 10,
      "text_blocks": 13,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 11,
      "text_blocks": 37,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 12,
      "text_blocks": 11,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 13,
      "text_blocks": 15,
      "layout_blocks": 2,
      "xobjects_found": 2,
      "xobjects_exported": 2,
      "reused_exported": 0,
      "rasterized": 2,
      "tables_found": 1
    },
    {
      "page": 14,
      "text_blocks": 8,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 2
    },
    {
      "page": 15,
      "text_blocks": 9,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 3
    },
    {
      "page": 16,
      "text_blocks": 16,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 2
    },
    {
      "page": 17,
      "text_blocks": 14,
      "layout_blocks": 1,
      "xobjects_found": 1,
      "xobjects_exported": 1,
      "reused_exported": 0,
      "rasterized": 1,
      "tables_found": 1
    },
    {
      "page": 18,
      "text_blocks": 7,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 19,
      "text_blocks": 14,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 20,
      "text_blocks": 8,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 2
    },
    {
      "page": 21,
      "text_blocks": 14,
      "layout_blocks": 1,
      "xobjects_found": 1,
      "xobjects_exported": 1,
      "reused_exported": 0,
      "rasterized": 1,
      "tables_found": 1
    },
    {
      "page": 22,
      "text_blocks": 8,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 2
    },
    {
      "page": 23,
      "text_blocks": 8,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 2
    },
    {
      "page": 24,
      "text_blocks": 8,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 25,
      "text_blocks": 10,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 26,
      "text_blocks": 16,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 27,
      "text_blocks": 18,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 28,
      "text_blocks": 14,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    },
    {
      "page": 29,
      "text_blocks": 16,
      "layout_blocks": 0,
      "xobjects_found": 0,
      "xobjects_exported": 0,
      "reused_exported": 0,
      "rasterized": 0,
      "tables_found": 1
    }
  ],
  "texts": [
    {
      "page_no": 1,
      "bbox": [
        84.08899688720703,
        107.42056274414062,
        519.0786743164062,
        146.61782836914062
      ],
      "text": "waywiser: Ergonomic Methods for Assessing Spatial\nModels"
    },
    {
      "page_no": 1,
      "bbox": [
        119.54499816894531,
        172.80735778808594,
        487.2472229003906,
        198.06683349609375
      ],
      "text": "Michael J Mahoney\nState University of New York College of Environmental Science and Forestry"
    },
    {
      "page_no": 1,
      "bbox": [
        279.5820007324219,
        236.13775634765625,
        323.4173889160156,
        246.10035705566406
      ],
      "text": "Abstract"
    },
    {
      "page_no": 1,
      "bbox": [
        108.27297973632812,
        254.63926696777344,
        494.8915100097656,
        455.8847961425781
      ],
      "text": "Assessing predictive models can be challenging. Modelers must navigate a wide array\nof evaluation methodologies implemented with incompatible interfaces across multiple\npackages which may give diﬀerent or even contradictory results, while ensuring that their\nchosen approach properly estimates the performance of their model when generalizing\nto new observations. Assessing models ﬁt to spatial data can be particularly diﬃcult,\ngiven that model errors may exhibit spatial autocorrelation, model predictions are often\naggregated to multiple spatial scales by end users, and models are often tasked with\ngeneralizing into spatial regions outside the boundaries of their initial training data.\nThe waywiser package for the R language attempts to make assessing spatial models\neasier by providing an ergonomic toolkit for model evaluation tasks, with functions for\nmultiple assessment methodologies sharing a uniﬁed interface. Functions from waywiser\nshare standardized argument names and default values, making the user-facing interface\nsimple and easy to learn. These functions are additionally designed to be easy to inte-\ngrate into a wide variety of modeling workﬂows, accepting standard classes as inputs and\nreturning size- and type-stable outputs, ensuring that their results are of consistent and\npredictable data types and dimensions. Additional features make it particularly easy to\nuse waywiser along packages and workﬂows in the tidymodels ecosystem."
    },
    {
      "page_no": 1,
      "bbox": [
        80.99998474121094,
        470.9691467285156,
        427.5077209472656,
        481.8917541503906
      ],
      "text": "Keywords: spatial modeling, model assessment, applicability domains, R."
    },
    {
      "page_no": 1,
      "bbox": [
        247.20799255371094,
        538.9837036132812,
        355.80865478515625,
        553.3298950195312
      ],
      "text": "1. Introduction"
    },
    {
      "page_no": 1,
      "bbox": [
        81.0,
        566.9766845703125,
        522.2186279296875,
        686.2787475585938
      ],
      "text": "Assessing predictive models can be challenging. Modelers must pick from a wide variety of\nevaluation approaches, each of which may give diﬀerent and even contradictory results (Reich\nand Barai 1999), and ensure that their chosen approach will properly estimate their model’s\nperformance when generalizing to observations not used to train the model. Even more com-\nplicated is assessing models ﬁt to spatial data, where errors may not be randomly distributed\nacross the study area (Legendre and Fortin 1989), predictions are often aggregated into larger\nunits which may compound existing spatial error patterns, requiring model accuracy assess-\nments at multiple spatial scales (Riemann et al. 2010), and models are often used to predict\nareas outside of the spatial boundary of the initial study area (Meyer and Pebesma 2021)."
    },
    {
      "page_no": 1,
      "bbox": [
        81.0,
        693.9236450195312,
        522.1968994140625,
        745.4807739257812
      ],
      "text": "Statistical software can help mitigate some of the complexity created by the array of consider-\nations and approaches for evaluating models ﬁt to spatial data. By providing a common user\ninterface for multiple well-established evaluation procedures, software can make it easier for\nusers to switch between evaluation approaches as appropriate for their current task, helping"
    },
    {
      "page_no": 1,
      "bbox": [
        10.940000534057617,
        256.59002685546875,
        37.619998931884766,
        609.8900146484375
      ],
      "text": "arXiv:2303.11312v1  [cs.MS]  20 Mar 2023"
    },
    {
      "page_no": 2,
      "bbox": [
        81.0,
        75.4158706665039,
        450.47955322265625,
        86.351806640625
      ],
      "text": "2\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 2,
      "bbox": [
        81.00000762939453,
        111.30873107910156,
        522.1641235351562,
        162.8648681640625
      ],
      "text": "reduce some of the cognitive load associated with switching between diﬀerent tasks (Roehm\net al. 2012). User interfaces should also make it easy to follow scientiﬁc and statistical best\npractices, and similarly make it diﬃcult to commit methodological errors (Kuhn and Silge\n2022)."
    },
    {
      "page_no": 2,
      "bbox": [
        81.0,
        169.43727111816406,
        522.2295532226562,
        302.30291748046875
      ],
      "text": "Many excellent R packages aim to help reduce this complexity and promote best practices\nby addressing individual aspects of model evaluation. Among many others, packages like\nyardstick (Kuhn et al. 2023), metrica (Correndo et al. 2022), and hydroGOF (Zambrano-\nBigiarini 2020) provide suites of metrics for model assessment, providing standard interfaces\nfor calculating model accuracy and agreement given vectors of observed and predicted values.\nPackages like spdep (Bivand and Wong 2018) and rgeoda (Li and Anselin 2023), meanwhile,\nprovide measures of spatial autocorrelation, helping modelers assess the spatial distribution of\nmodel errors. Finally, several packages implement additional evaluation approaches beyond\nstandard error assessments; for instance, CAST (Meyer et al. 2023) and applicable (Gotti and\nKuhn 2022) implement approaches for calculating model applicability domains."
    },
    {
      "page_no": 2,
      "bbox": [
        81.0,
        308.8609924316406,
        522.2078247070312,
        428.19000244140625
      ],
      "text": "The new waywiser package implements elements of each of these approaches, while provid-\ning a consistent, ergonomic user interface for each aspect of model assessment. Functions in\nwaywiser provide new implementations of several popular assessment metrics from the spatial\nmodeling literature, and provide a wrapper around functions for calculating spatial autocor-\nrelation metrics. Additional functions provide an approach for assessing model predictions\naggregated to multiple spatial scales, and a new implementation of the dissimilarity index\nand area of applicability from Meyer and Pebesma (2021). These functions share a consistent\ninterface, with standardized argument names and deﬁnitions, making it easy for users to learn\nhow to use the package, and to switch between evaluation approaches as desired."
    },
    {
      "page_no": 2,
      "bbox": [
        81.0,
        434.7490539550781,
        522.175048828125,
        594.72607421875
      ],
      "text": "Outputs from waywiser are both type-stable and size-stable, making waywiser functions both\npredictable and easy to program with. Functions in waywiser additionally accept inputs and\nreturn outputs using standard classes, using objects from the popular sf (Pebesma 2018)\npackage for spatial data and simple data frames and vectors otherwise. This predictability\nand reliance on well-established classes makes it easy to use waywiser with the majority of\nmodeling tools in R. Additional features make it particularly easy to combine waywiser with\npackages in the tidymodels modeling framework (Kuhn and Silge 2022). For instance, while\nwaywiser does not itself provide any functions for performing cross-validation or hyperpa-\nrameter selection, functions from waywiser integrate naturally with the tune package (Kuhn\n2022b), allowing for cross-validated model assessment using data splits from rsample (Frick\net al. 2022) and spatialsample (Mahoney and Silge 2023) and automated hyperparameter\nselection using dials (Kuhn and Frick 2022)."
    },
    {
      "page_no": 2,
      "bbox": [
        81.0,
        601.2841186523438,
        522.2076416015625,
        679.966064453125
      ],
      "text": "The rest of this article walks through features in waywiser, starting with functions imple-\nmenting (or wrapping implementations of) model assessment metrics (Section 3), followed by\nmethods for assessing model performance when aggregating predictions across multiple spa-\ntial scales (Section 4), then by functions for calculating the applicability domain of a model\n(Section 5). An additional section discusses how waywiser integrates with the tidymodels\nmodeling framework (Section 6)."
    },
    {
      "page_no": 2,
      "bbox": [
        242.71299743652344,
        707.638916015625,
        360.00750732421875,
        721.985107421875
      ],
      "text": "2. Example data"
    },
    {
      "page_no": 2,
      "bbox": [
        81.0,
        734.5718994140625,
        541.7264404296875,
        746.0340576171875
      ],
      "text": "For demonstration purposes, this paper will assess a linear model ﬁt to the worldclim_simulation"
    },
    {
      "page_no": 3,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        527.4545288085938,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n3"
    },
    {
      "page_no": 3,
      "bbox": [
        81.0,
        111.28189849853516,
        522.0912475585938,
        203.51287841796875
      ],
      "text": "data included in waywiser, containing a random sample of 10,000 points from the WorldClim\nBioclimatic variables data set (Fick and Hijmans 2017). Variable “bio2” records the mean\nmonthly diurnal temperature range, “bio10” the mean temperature of the warmest 3 months\nof the year, “bio13” the precipitation of the wettest month of the year, and “bio19” the\nprecipitation of the coldest 3 months of the year. A ﬁnal variable, “response”, was simulated\nusing the virtualspecies package following examples in CAST (Leroy et al. 2015; Meyer et al.\n2023)."
    },
    {
      "page_no": 3,
      "bbox": [
        81.0,
        209.23976135253906,
        522.1967163085938,
        274.34490966796875
      ],
      "text": "To create this model, we will ﬁrst split our data into training and test sets, resembling a\nstandard predictive modeling workﬂow. For simplicity, we will assign observations to these\nsets at random; in actual practice, it would be best to use spatial cross-validation approaches\nin order to address any spatial autocorrelation in the response variable (Mahoney and Silge\n2023)."
    },
    {
      "page_no": 3,
      "bbox": [
        81.0,
        290.0688781738281,
        464.7271728515625,
        368.7239990234375
      ],
      "text": "R> set.seed(1107)\nR> data(\"worldclim_simulation\", package = \"waywiser\")\nR> worldclim_training <- sample(nrow(worldclim_simulation),\n+\nnrow(worldclim_simulation) * 0.8)\nR> worldclim_testing <- worldclim_simulation[-worldclim_training, ]\nR> worldclim_training <- worldclim_simulation[worldclim_training, ]"
    },
    {
      "page_no": 3,
      "bbox": [
        81.0,
        383.3273620605469,
        522.0911254882812,
        407.7989807128906
      ],
      "text": "We then ﬁt a linear model using base R’s lm() function, and use the resulting model to\ngenerate predictions for our test set:"
    },
    {
      "page_no": 3,
      "bbox": [
        81.00003051757812,
        423.5219421386719,
        453.2726745605469,
        475.07904052734375
      ],
      "text": "R> worldclim_model <- lm(response ~ bio2 + bio10 + bio13 + bio19,\n+\ndata = worldclim_training)\nR> worldclim_testing$predictions <- predict(worldclim_model,\n+\nworldclim_testing)"
    },
    {
      "page_no": 3,
      "bbox": [
        199.94302368164062,
        508.3339538574219,
        403.128173828125,
        522.6801147460938
      ],
      "text": "3. Model assessment metrics"
    },
    {
      "page_no": 3,
      "bbox": [
        81.0000228881836,
        546.9595947265625,
        219.85964965820312,
        558.914794921875
      ],
      "text": "3.1. Agreement metrics"
    },
    {
      "page_no": 3,
      "bbox": [
        81.0,
        568.2371215820312,
        522.1858520507812,
        646.9190063476562
      ],
      "text": "Several functions in waywiser revolve around calculating model agreement metrics: numeric\nindices of how closely model predictions (which we refer to as ˆy) align with another data set\n(y), with y typically (but not necessarily) representing “true” measured values. This set of\nmetrics generally originated within the spatial modeling literature and are most popular for\nassessing models ﬁt to spatial data, but do not incorporate any geographic information into\ntheir calculation."
    },
    {
      "page_no": 3,
      "bbox": [
        80.99999237060547,
        652.6458740234375,
        522.1751098632812,
        704.2019653320312
      ],
      "text": "For instance, in a series of papers, Willmott (1980; 1981; 1982) introduced a index of agree-\nment, d. This metric represents the agreement of model predictions (ˆy) with observed values\n(y) as the ratio of the sum of squared diﬀerences to the sum of the absolute values of diﬀerences\nin predicted and observed values from the observed mean (¯y); that is:"
    },
    {
      "page_no": 3,
      "bbox": [
        220.39199829101562,
        728.3130493164062,
        256.9812927246094,
        739.3770141601562
      ],
      "text": "d = 1 −"
    },
    {
      "page_no": 3,
      "bbox": [
        260.5989990234375,
        718.3541259765625,
        522.0018310546875,
        750.9597778320312
      ],
      "text": "Pn\ni=1 (ˆyi −yi)2\nPn\ni=1 (|ˆyi −¯y| + |yi −¯y|)2\n(1)"
    },
    {
      "page_no": 4,
      "bbox": [
        81.0,
        75.4158706665039,
        450.47955322265625,
        86.351806640625
      ],
      "text": "4\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 4,
      "bbox": [
        81.00000762939453,
        111.29524230957031,
        522.1122436523438,
        189.9638671875
      ],
      "text": "This formulation means that d is bounded [0, 1], with higher values of d indicating greater\nagreement between y and ˆy. As a dimensionless metric, d is a useful tool for comparing models;\nhowever, the use of summed diﬀerences in the numerator means that d is oversensitive to\noutliers in ˆyi−yi (Legates and McCabe 1999). To address this concern, Willmott et al. (1985)\nintroduced a revised metric named d1, using the sum of the absolute values of diﬀerences in\nthe place of the sum of squared diﬀerences and no longer squaring the denominator:"
    },
    {
      "page_no": 4,
      "bbox": [
        220.39205932617188,
        212.1519012451172,
        261.71331787109375,
        224.8529052734375
      ],
      "text": "d1 = 1 −"
    },
    {
      "page_no": 4,
      "bbox": [
        265.33099365234375,
        202.6572265625,
        522.0017700195312,
        233.45184326171875
      ],
      "text": "Pn\ni=1 |ˆyi −yi|\nPn\ni=1 (|ˆyi −¯y| + |yi −¯y|)\n(2)"
    },
    {
      "page_no": 4,
      "bbox": [
        80.99992370605469,
        240.44728088378906,
        522.1268310546875,
        278.4678955078125
      ],
      "text": "As with d, d1 is bounded [0, 1] with higher values indicating improved agreement; Willmott\n(2011) notes that d1 approaches 1 more slowly than d, allowing for ﬁner-grained comparisons\nbetween well-performing models."
    },
    {
      "page_no": 4,
      "bbox": [
        80.99990844726562,
        284.2538146972656,
        522.2047729492188,
        336.7913513183594
      ],
      "text": "Willmott et al. revisited these indices twenty-ﬁve years later (2011), noting that interpretation\nof d and d1 was made diﬃcult both by the limited range of the metric and by the inclusion\nof ˆy in the denominator, which made the scaling factor of the agreement metric dependent\nupon the model itself. To address this, they introduce a new metric dr, such that:"
    },
    {
      "page_no": 4,
      "bbox": [
        202.8369140625,
        391.42633056640625,
        224.58718872070312,
        403.9859313964844
      ],
      "text": "dr ="
    },
    {
      "page_no": 4,
      "bbox": [
        227.6149139404297,
        351.7705078125,
        236.47166442871094,
        397.5992126464844
      ],
      "text": "\n\n\n\n\n\n\n\n\n\n"
    },
    {
      "page_no": 4,
      "bbox": [
        227.6149139404297,
        405.5686340332031,
        236.47166442871094,
        442.43133544921875
      ],
      "text": "\n\n\n\n\n\n\n\n\n"
    },
    {
      "page_no": 4,
      "bbox": [
        241.45191955566406,
        357.99920654296875,
        257.8182067871094,
        369.06317138671875
      ],
      "text": "1 −"
    },
    {
      "page_no": 4,
      "bbox": [
        261.4360046386719,
        348.5035095214844,
        362.91680908203125,
        383.48895263671875
      ],
      "text": "Pn\ni=1 |ˆyi −yi|\nc Pn\ni=1 |yi −¯y|, when"
    },
    {
      "page_no": 4,
      "bbox": [
        241.45196533203125,
        389.1520690917969,
        386.32861328125,
        409.27490234375
      ],
      "text": "Pn\ni=1 |ˆyi −yi| ≤c Pn\ni=1 |yi −¯y|"
    },
    {
      "page_no": 4,
      "bbox": [
        242.6479034423828,
        414.9480285644531,
        378.16241455078125,
        445.5879211425781
      ],
      "text": "c Pn\ni=1 |yi −¯y|\nPn\ni=1 |ˆyi −yi| −1 otherwise"
    },
    {
      "page_no": 4,
      "bbox": [
        391.3070068359375,
        351.7703552246094,
        400.16375732421875,
        397.59906005859375
      ],
      "text": "\n\n\n\n\n\n\n\n\n\n"
    },
    {
      "page_no": 4,
      "bbox": [
        391.3070068359375,
        405.5684814453125,
        400.16375732421875,
        442.4311828613281
      ],
      "text": "\n\n\n\n\n\n\n\n\n"
    },
    {
      "page_no": 4,
      "bbox": [
        508.05999755859375,
        391.43994140625,
        522.0018310546875,
        402.3490295410156
      ],
      "text": "(3)"
    },
    {
      "page_no": 4,
      "bbox": [
        81.0,
        452.7384338378906,
        522.0052490234375,
        463.6610412597656
      ],
      "text": "Where c is a scaling constant set to 2. A full derivation is provided in Willmott et al. (2011)."
    },
    {
      "page_no": 4,
      "bbox": [
        80.99993896484375,
        469.29107666015625,
        522.0426025390625,
        507.45404052734375
      ],
      "text": "Compared to d and d1, dr provides a larger metric range (being bounded [−1, 1], with 1\nindicating perfect agreement) and is more directly interpretable; dr is proportional to the\nmean absolute error divided by c times the mean absolute deviation."
    },
    {
      "page_no": 4,
      "bbox": [
        80.99993896484375,
        513.2254028320312,
        522.1858520507812,
        605.4430541992188
      ],
      "text": "These agreement metrics are all asymmetric, assuming that y values are more accurate than\nˆy. This makes this set of metrics useful when comparing model predictions against measured\nvalues, as measured values used to train models are generally assumed to be more trustworthy\nthan model predictions. However, in some model assessment scenarios it can be desirable to\ntreat both y and ˆy as capable of containing error. For instance, when comparing two distinct\nsets of model predictions, it is typically desirable to not treat whichever set of predictions is\nlabeled as y as being inherently more accurate."
    },
    {
      "page_no": 4,
      "bbox": [
        80.99996948242188,
        611.2289428710938,
        522.0073852539062,
        635.6870727539062
      ],
      "text": "For this reason, Ji and Gallo (2006) introduce an agreement coeﬃcient, AC, which is sym-\nmetrical and allows for errors in both y and ˆy:"
    },
    {
      "page_no": 4,
      "bbox": [
        170.73997497558594,
        659.8571166992188,
        217.4082489013672,
        670.9210815429688
      ],
      "text": "AC = 1 −"
    },
    {
      "page_no": 4,
      "bbox": [
        290.77197265625,
        649.898193359375,
        360.81805419921875,
        666.2930297851562
      ],
      "text": "Pn\ni=1 (ˆyi −yi)2"
    },
    {
      "page_no": 4,
      "bbox": [
        221.0260009765625,
        660.01171875,
        522.0018310546875,
        688.4869995117188
      ],
      "text": "Pn\ni=1\n\u0010\f\f\f¯ˆy −¯y\n\f\f\f +\n\f\f\fˆyi −¯ˆy\n\f\f\f\n\u0011 \u0010\f\f\f¯ˆy −¯y\n\f\f\f + |yi −¯y|\n\u0011\n(4)"
    },
    {
      "page_no": 4,
      "bbox": [
        80.99996948242188,
        693.9102172851562,
        522.1859741210938,
        752.4240112304688
      ],
      "text": "Unlike d and related metrics, AC is symmetrical, producing identical values if y and ˆy are\nreversed. This makes AC a preferable metric for comparing predictions from models, as it\ndoes not assume either set of predictions to be more accurate than the other. Ji and Gallo\n(2006) describe AC as bounded [0, 1], as when Pn\ni=1 yi = ¯y and Pn\ni=1 ˆyi = ¯ˆy (as would occur"
    },
    {
      "page_no": 5,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        527.4545288085938,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n5"
    },
    {
      "page_no": 5,
      "bbox": [
        80.99996948242188,
        111.30873107910156,
        522.1749877929688,
        176.4149169921875
      ],
      "text": "under a null model) the fractional term simpliﬁes to 1 and thus AC is 0. In practice however,\nthe null model is not the true lower bound for how poorly two data sets can agree with one\nanother; it is entirely possible for poor models with large diﬀerences between yi and ˆyi to\nproduce negative AC estimates, with true bounds of (−∞, 1]. Worse agreement between yi\nand y produces smaller values."
    },
    {
      "page_no": 5,
      "bbox": [
        81.00001525878906,
        182.1678009033203,
        522.1314086914062,
        233.72491455078125
      ],
      "text": "In addition to these dimensionless agreement metrics, these authors also suggest a host of\nmetrics for model assessment in units of y, which may then be decomposed into systematic and\nunsystematic components. For instance, Willmott (1981) walks through the decomposition\nof the familiar mean squared error (MSE):"
    },
    {
      "page_no": 5,
      "bbox": [
        246.99700927734375,
        250.21180725097656,
        292.2245788574219,
        268.50091552734375
      ],
      "text": "MSE = 1"
    },
    {
      "page_no": 5,
      "bbox": [
        286.2229919433594,
        265.06219482421875,
        292.7684631347656,
        275.9713134765625
      ],
      "text": "n"
    },
    {
      "page_no": 5,
      "bbox": [
        295.7839660644531,
        247.1861572265625,
        310.179931640625,
        265.7429504394531
      ],
      "text": "n\nX"
    },
    {
      "page_no": 5,
      "bbox": [
        296.1279602050781,
        254.85903930664062,
        522.0017700195312,
        280.0281066894531
      ],
      "text": "i=1\n(ˆyi −yi)2\n(5)"
    },
    {
      "page_no": 5,
      "bbox": [
        80.99993896484375,
        287.7767639160156,
        522.0131225585938,
        312.23486328125
      ],
      "text": "Into its systematic and unsystematic components, with the systematic component of MSE\ngiven by:"
    },
    {
      "page_no": 5,
      "bbox": [
        244.4659423828125,
        328.7227783203125,
        294.10748291015625,
        348.6478576660156
      ],
      "text": "MSEs = 1"
    },
    {
      "page_no": 5,
      "bbox": [
        288.1059875488281,
        343.57220458984375,
        294.6514587402344,
        354.4813232421875
      ],
      "text": "n"
    },
    {
      "page_no": 5,
      "bbox": [
        297.66796875,
        325.6961364746094,
        312.0639343261719,
        344.25396728515625
      ],
      "text": "n\nX"
    },
    {
      "page_no": 5,
      "bbox": [
        298.0109558105469,
        350.5581359863281,
        311.7093811035156,
        358.5380859375
      ],
      "text": "i=1"
    },
    {
      "page_no": 5,
      "bbox": [
        313.8759460449219,
        332.6189880371094,
        522.0017700195312,
        349.05322265625
      ],
      "text": "\u0000ˆyi −y′\ni\n\u00012\n(6)"
    },
    {
      "page_no": 5,
      "bbox": [
        80.99993896484375,
        366.2877197265625,
        327.9671630859375,
        377.1968078613281
      ],
      "text": "And the unsystematic component of MSE given by:"
    },
    {
      "page_no": 5,
      "bbox": [
        243.97193908691406,
        393.6837158203125,
        294.6004943847656,
        413.60980224609375
      ],
      "text": "MSEu = 1"
    },
    {
      "page_no": 5,
      "bbox": [
        288.6000061035156,
        408.533203125,
        295.1454772949219,
        419.44232177734375
      ],
      "text": "n"
    },
    {
      "page_no": 5,
      "bbox": [
        298.1610107421875,
        390.6571350097656,
        312.5569763183594,
        409.2149658203125
      ],
      "text": "n\nX"
    },
    {
      "page_no": 5,
      "bbox": [
        298.5050048828125,
        415.5201416015625,
        312.20343017578125,
        423.5000915527344
      ],
      "text": "i=1"
    },
    {
      "page_no": 5,
      "bbox": [
        314.3699951171875,
        397.5799865722656,
        522.0018310546875,
        414.01422119140625
      ],
      "text": "\u0000yi −y′\ni\n\u00012\n(7)"
    },
    {
      "page_no": 5,
      "bbox": [
        81.0,
        428.1617126464844,
        522.0160522460938,
        456.5788269042969
      ],
      "text": "Where y′ is the predicted value of y from the linear regression model y′ = a + bˆy. These two\ncomponents sum to MSE:"
    },
    {
      "page_no": 5,
      "bbox": [
        248.03103637695312,
        475.8817443847656,
        522.0018310546875,
        488.42681884765625
      ],
      "text": "MSE = MSEs + MSEu\n(8)"
    },
    {
      "page_no": 5,
      "bbox": [
        81.0,
        497.9222412109375,
        522.1402587890625,
        535.94287109375
      ],
      "text": "As MSE is in squared units of y, it is typically more useful to use the root mean squared error\n(RMSE) and its systematic and unsystematic components, calculated by taking the square\nroot of MSE and its components."
    },
    {
      "page_no": 5,
      "bbox": [
        81.0,
        541.69677734375,
        522.1748657226562,
        579.7039184570312
      ],
      "text": "Ji and Gallo (2006) present a similar decomposition for their AC metric, using a geometric\nmean functional relationship (GMFR) model in place of the linear regression to allow for\nerrors in both y and ˆy (Draper and Yang 1997). The GMFR is estimated such that:"
    },
    {
      "page_no": 5,
      "bbox": [
        236.1389923095703,
        591.4337768554688,
        289.2045593261719,
        606.8468627929688
      ],
      "text": "y′ = a + bˆy"
    },
    {
      "page_no": 5,
      "bbox": [
        239.99200439453125,
        631.8248901367188,
        267.706298828125,
        642.8888549804688
      ],
      "text": "b = ±"
    },
    {
      "page_no": 5,
      "bbox": [
        269.52203369140625,
        616.619384765625,
        278.23931884765625,
        626.58203125
      ],
      "text": ""
    },
    {
      "page_no": 5,
      "bbox": [
        269.52203369140625,
        634.1534423828125,
        278.23931884765625,
        650.4920654296875
      ],
      "text": "\n"
    },
    {
      "page_no": 5,
      "bbox": [
        279.4350280761719,
        615.373046875,
        349.9061279296875,
        634.6342163085938
      ],
      "text": "Pn\ni=1\n\u0010\nˆyi −¯ˆy\n\u00112"
    },
    {
      "page_no": 5,
      "bbox": [
        281.14300537109375,
        638.0769653320312,
        348.1990966796875,
        654.4718017578125
      ],
      "text": "Pn\ni=1 (yi −¯y)2"
    },
    {
      "page_no": 5,
      "bbox": [
        351.60198974609375,
        616.6193237304688,
        360.31927490234375,
        626.5819702148438
      ],
      "text": ""
    },
    {
      "page_no": 5,
      "bbox": [
        351.60198974609375,
        634.1533203125,
        360.31927490234375,
        650.4920043945312
      ],
      "text": "\n"
    },
    {
      "page_no": 5,
      "bbox": [
        361.5149841308594,
        611.687744140625,
        365.1673278808594,
        624.04931640625
      ],
      "text": "1\n2"
    },
    {
      "page_no": 5,
      "bbox": [
        238.90701293945312,
        661.0286865234375,
        289.1775817871094,
        674.7567749023438
      ],
      "text": "a = ¯ˆy −b¯y"
    },
    {
      "page_no": 5,
      "bbox": [
        508.0600280761719,
        629.90966796875,
        522.0018310546875,
        640.8187866210938
      ],
      "text": "(9)"
    },
    {
      "page_no": 5,
      "bbox": [
        81.00003051757812,
        684.9751586914062,
        522.0046997070312,
        709.44677734375
      ],
      "text": "Where the sign of b is the same sign as the correlation coeﬃcient between y and ˆy. This\nregression equation can be reversed to predict ˆy, represented by ˆy′, as a function of y:"
    },
    {
      "page_no": 5,
      "bbox": [
        268.5650329589844,
        723.0531616210938,
        307.096923828125,
        741.3557739257812
      ],
      "text": "ˆy′ = −a"
    },
    {
      "page_no": 5,
      "bbox": [
        301.8689880371094,
        723.0667114257812,
        330.75555419921875,
        748.8388061523438
      ],
      "text": "b + 1"
    },
    {
      "page_no": 5,
      "bbox": [
        322.8169860839844,
        730.4466552734375,
        522.0023803710938,
        748.8253173828125
      ],
      "text": "by\n(10)"
    },
    {
      "page_no": 6,
      "bbox": [
        81.0,
        75.4158706665039,
        450.47955322265625,
        86.351806640625
      ],
      "text": "6\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 6,
      "bbox": [
        80.99996948242188,
        111.30873107910156,
        522.1531372070312,
        162.8648681640625
      ],
      "text": "Ji and Gallo (2006) use these quantities to decompose the sum of squared diﬀerences into\nsystematic and unsystematic components, which they refer to as the systematic and unsys-\ntematic sum of product diﬀerences (SPD). The unsystematic component of SPD is deﬁned\nas:"
    },
    {
      "page_no": 6,
      "bbox": [
        220.88597106933594,
        186.79676818847656,
        259.62225341796875,
        199.3428955078125
      ],
      "text": "SPDu ="
    },
    {
      "page_no": 6,
      "bbox": [
        262.6509704589844,
        176.39019775390625,
        277.04693603515625,
        194.94802856445312
      ],
      "text": "n\nX"
    },
    {
      "page_no": 6,
      "bbox": [
        262.99395751953125,
        201.252197265625,
        276.6923828125,
        209.23214721679688
      ],
      "text": "i=1"
    },
    {
      "page_no": 6,
      "bbox": [
        278.85894775390625,
        184.47286987304688,
        522.0023193359375,
        201.92208862304688
      ],
      "text": "\u0002\u0000\f\fˆyi −ˆy′\ni\n\f\f\u0001 \u0000\f\fyi −y′\ni\n\f\f\u0001\u0003\n(11)"
    },
    {
      "page_no": 6,
      "bbox": [
        80.99996948242188,
        217.4549102783203,
        522.034912109375,
        241.91302490234375
      ],
      "text": "While the systematic component is found by subtracting SPDu from the sum of squared\ndiﬀerences:"
    },
    {
      "page_no": 6,
      "bbox": [
        168.8289794921875,
        266.3979187011719,
        206.57925415039062,
        278.94403076171875
      ],
      "text": "SPDs ="
    },
    {
      "page_no": 6,
      "bbox": [
        209.6069793701172,
        255.9913330078125,
        231.88992309570312,
        274.5491638183594
      ],
      "text": "n\nX"
    },
    {
      "page_no": 6,
      "bbox": [
        217.8379669189453,
        257.0146789550781,
        285.6033630371094,
        288.8343200683594
      ],
      "text": "i=1\n(ˆyi −yi)2\n!"
    },
    {
      "page_no": 6,
      "bbox": [
        288.02398681640625,
        266.2431640625,
        296.5112609863281,
        277.1522521972656
      ],
      "text": "−"
    },
    {
      "page_no": 6,
      "bbox": [
        298.9329833984375,
        255.991455078125,
        321.2159423828125,
        274.5492858886719
      ],
      "text": "n\nX"
    },
    {
      "page_no": 6,
      "bbox": [
        307.1639709472656,
        280.8544921875,
        320.8623962402344,
        288.8344421386719
      ],
      "text": "i=1"
    },
    {
      "page_no": 6,
      "bbox": [
        323.0289611816406,
        257.0148620605469,
        434.1744079589844,
        281.5234069824219
      ],
      "text": "\u0002\u0000\f\fˆyi −ˆy′\ni\n\f\f\u0001 \u0000\f\fyi −y′\ni\n\f\f\u0001\u0003\n!"
    },
    {
      "page_no": 6,
      "bbox": [
        502.60601806640625,
        266.3982238769531,
        522.0023803710938,
        277.30731201171875
      ],
      "text": "(12)"
    },
    {
      "page_no": 6,
      "bbox": [
        81.00003051757812,
        297.0562438964844,
        522.1533203125,
        323.15032958984375
      ],
      "text": "Taking the arithmetic mean of these terms produces the unsystematic and systematic mean\nproduct diﬀerence (MPDu and MPDs, respectively):"
    },
    {
      "page_no": 6,
      "bbox": [
        255.41705322265625,
        335.1982421875,
        308.318603515625,
        355.1233215332031
      ],
      "text": "MPDu = 1"
    },
    {
      "page_no": 6,
      "bbox": [
        302.3169860839844,
        342.5777282714844,
        522.0023803710938,
        360.9698181152344
      ],
      "text": "n (SPDu)\n(13)"
    },
    {
      "page_no": 6,
      "bbox": [
        256.4040222167969,
        372.9707336425781,
        308.3185729980469,
        392.89581298828125
      ],
      "text": "MPDs = 1"
    },
    {
      "page_no": 6,
      "bbox": [
        302.3169860839844,
        380.3507080078125,
        522.0023803710938,
        398.7427978515625
      ],
      "text": "n (SPDs)\n(14)"
    },
    {
      "page_no": 6,
      "bbox": [
        81.0,
        405.3227233886719,
        522.1751098632812,
        456.8797912597656
      ],
      "text": "These quantities can be expressed as a ratio of MSE to represent the proportion of systematic\nand unsystematic disagreement between y and ˆy. The square roots of MPDu and MPDs\n(RMPDu and RMPDs, respectively) are in units of y and may be useful ways to describe\nsystematic and unsystematic disagreement in absolute units."
    },
    {
      "page_no": 6,
      "bbox": [
        80.99996948242188,
        462.69671630859375,
        522.1749877929688,
        500.7048034667969
      ],
      "text": "As SPDu and SPDs sum to the sum of squared diﬀerences, the numerator of AC (Equation\n(4)) can then be decomposed into systematic and unsystematic components by replacing the\nnumerator with the appropriate component of SPD:"
    },
    {
      "page_no": 6,
      "bbox": [
        168.03897094726562,
        515.03369140625,
        522.0023803710938,
        550.8889770507812
      ],
      "text": "ACu = 1 −\nSPDu\nPn\ni=1\n\u0010\f\f\f¯ˆy −¯y\n\f\f\f +\n\f\f\fˆyi −¯ˆy\n\f\f\f\n\u0011 \u0010\f\f\f¯ˆy −¯y\n\f\f\f + |yi −¯y|\n\u0011\n(15)"
    },
    {
      "page_no": 6,
      "bbox": [
        168.53302001953125,
        557.4996337890625,
        522.0023803710938,
        593.35400390625
      ],
      "text": "ACs = 1 −\nSPDs\nPn\ni=1\n\u0010\f\f\f¯ˆy −¯y\n\f\f\f +\n\f\f\fˆyi −¯ˆy\n\f\f\f\n\u0011 \u0010\f\f\f¯ˆy −¯y\n\f\f\f + |yi −¯y|\n\u0011\n(16)"
    },
    {
      "page_no": 6,
      "bbox": [
        80.99996948242188,
        599.0527954101562,
        522.2186889648438,
        746.0337524414062
      ],
      "text": "These metrics are all implemented in waywiser using the infrastructure provided by yardstick\n(Kuhn et al. 2023).\nFunctions are preﬁxed with ww_, to help with autocompletion inside\nof code editors, and all share identical user interfaces.\nThe main version of each metric\nfunction takes three primary arguments, namely data (an object inheriting the data.frame\nS3 class), truth (the name of the column containing y), and estimate (the name of the\ncolumn containing ˆy). Both truth and estimate follow tidy evaluation rules, with the main\nuser-noticeable eﬀect being that these arguments accept either quoted or unquoted column\nidentiﬁers. These functions return a “tibble” (Müller and Wickham 2022) with a single row\nand three columns, .metric (containing the name of the metric), .estimator (containing the\nstring “standard”, for compatibility with yardstick and the broader tidymodels ecosystem),\nand .estimate (containing the metric estimate)."
    },
    {
      "page_no": 7,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        527.4545288085938,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n7"
    },
    {
      "page_no": 7,
      "bbox": [
        81.0,
        111.86178588867188,
        378.8182067871094,
        149.86891174316406
      ],
      "text": "R> waywiser::ww_willmott_d(data = worldclim_testing,\n+\ntruth = response,\n+\nestimate = predictions)"
    },
    {
      "page_no": 7,
      "bbox": [
        81.0,
        170.68978881835938,
        270.0006408691406,
        222.2469024658203
      ],
      "text": "# A tibble: 1 x 3\n.metric\n.estimator .estimate\n<chr>\n<chr>\n<dbl>\n1 willmott_d standard\n0.919"
    },
    {
      "page_no": 7,
      "bbox": [
        80.99996948242188,
        242.48788452148438,
        522.2076416015625,
        294.6248779296875
      ],
      "text": "When data is a grouped data frame, as produced by the group_by() function in dplyr\n(Wickham et al. 2023a), waywiser will calculate metrics independently for each group. In\nthese cases, the resulting tibble will have one row per group and include the columns used to\ngroup the data alongside the standard .metric, .estimator, and .estimate columns:"
    },
    {
      "page_no": 7,
      "bbox": [
        80.99996948242188,
        315.4457702636719,
        516.2725219726562,
        380.5518798828125
      ],
      "text": "R> worldclim_testing$group <- sample(1:2, nrow(worldclim_testing),\n+\nreplace = TRUE)\nR> waywiser::ww_willmott_d(data = dplyr::group_by(worldclim_testing, group),\n+\ntruth = response,\n+\nestimate = predictions)"
    },
    {
      "page_no": 7,
      "bbox": [
        80.99996948242188,
        401.372802734375,
        304.36419677734375,
        466.4789123535156
      ],
      "text": "# A tibble: 2 x 4\ngroup .metric\n.estimator .estimate\n<int> <chr>\n<chr>\n<dbl>\n1\n1 willmott_d standard\n0.924\n2\n2 willmott_d standard\n0.914"
    },
    {
      "page_no": 7,
      "bbox": [
        80.99996948242188,
        486.7467956542969,
        522.1245727539062,
        524.75390625
      ],
      "text": "These functions additionally each have a variant, suﬃxed with _vec, which directly accepts\nnumeric vectors to truth and estimate. These functions return a numeric vector with metric\nestimates."
    },
    {
      "page_no": 7,
      "bbox": [
        80.99998474121094,
        546.1279296875,
        487.63616943359375,
        570.5869140625
      ],
      "text": "R> waywiser::ww_willmott_d_vec(truth = worldclim_testing$response,\n+\nestimate = worldclim_testing$predictions)"
    },
    {
      "page_no": 7,
      "bbox": [
        80.99998474121094,
        591.4078979492188,
        155.45462036132812,
        602.3169555664062
      ],
      "text": "[1] 0.9187938"
    },
    {
      "page_no": 7,
      "bbox": [
        80.99998474121094,
        622.5847778320312,
        522.2404174804688,
        660.5918579101562
      ],
      "text": "Internally, data frame-based functions call their _vec variants to calculate metrics, ensur-\ning that identical calculations are performed (and therefore, identical results are returned)\nregardless of which interface is used."
    },
    {
      "page_no": 7,
      "bbox": [
        81.0,
        666.7990112304688,
        522.1969604492188,
        746.033935546875
      ],
      "text": "As these functions leverage infrastructure from the yardstick package, the data frame variants\ncan be combined using the yardstick function metric_set().\nThis function accepts any\nnumber of metric functions as an input and returns a new function to calculate all metrics\nin a single call. The returned function has the same user interface as the data frame metric\nfunctions, accepting the arguments data, truth, and estimate and returning a tibble with\nthe columns .metric, .estimator, and .estimate."
    },
    {
      "page_no": 8,
      "bbox": [
        81.0,
        75.4158706665039,
        450.47955322265625,
        86.351806640625
      ],
      "text": "8\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 8,
      "bbox": [
        81.00000762939453,
        111.86178588867188,
        487.63623046875,
        258.262939453125
      ],
      "text": "R> metrics <- yardstick::metric_set(\n+\nwaywiser::ww_willmott_d, waywiser::ww_willmott_d1,\n+\nwaywiser::ww_willmott_dr, waywiser::ww_systematic_mse,\n+\nwaywiser::ww_unsystematic_mse, waywiser::ww_systematic_rmse,\n+\nwaywiser::ww_unsystematic_rmse, waywiser::ww_agreement_coefficient,\n+\nwaywiser::ww_systematic_agreement_coefficient,\n+\nwaywiser::ww_unsystematic_agreement_coefficient,\n+\nwaywiser::ww_systematic_mpd, waywiser::ww_unsystematic_mpd,\n+\nwaywiser::ww_systematic_rmpd, waywiser::ww_unsystematic_rmpd)\nR> print(metrics(data = worldclim_testing,\n+\ntruth = response, estimate = predictions), n = 14)"
    },
    {
      "page_no": 8,
      "bbox": [
        81.00000762939453,
        275.9338684082031,
        413.18212890625,
        503.63006591796875
      ],
      "text": "# A tibble: 14 x 3\n.metric\n.estimator .estimate\n<chr>\n<chr>\n<dbl>\n1 willmott_d\nstandard\n0.919\n2 willmott_d1\nstandard\n0.729\n3 willmott_dr\nstandard\n0.759\n4 systematic_mse\nstandard\n0.0119\n5 unsystematic_mse\nstandard\n0.0000258\n6 systematic_rmse\nstandard\n0.109\n7 unsystematic_rmse\nstandard\n0.00508\n8 agreement_coefficient\nstandard\n0.658\n9 systematic_agreement_coefficient\nstandard\n0.980\n10 unsystematic_agreement_coefficient standard\n0.677\n11 systematic_mpd\nstandard\n0.000688\n12 unsystematic_mpd\nstandard\n0.0112\n13 systematic_rmpd\nstandard\n0.0262\n14 unsystematic_rmpd\nstandard\n0.106"
    },
    {
      "page_no": 8,
      "bbox": [
        81.00000762939453,
        533.49560546875,
        248.4205780029297,
        545.4508056640625
      ],
      "text": "3.2. Autocorrelation metrics"
    },
    {
      "page_no": 8,
      "bbox": [
        81.0,
        555.1371459960938,
        522.1858520507812,
        633.8190307617188
      ],
      "text": "In addition to its set of agreement metrics, waywiser provides a set of functions for measuring\nspatial autocorrelation in model residuals.\nThese functions provide a thin wrapper over\nfunctions provided by the spdep package (Bivand and Wong 2018; Bivand 2022; Bivand et al.\n2008), meaning that (unlike the agreement metrics) metric calculations are not implemented\ndirectly in waywiser. Equations in this section are largely derived from Bivand and Wong\n(2018)."
    },
    {
      "page_no": 8,
      "bbox": [
        81.0,
        639.7269287109375,
        522.2185668945312,
        745.4810180664062
      ],
      "text": "Spatial autocorrelation metrics are designed to detect if values among neighboring obser-\nvations are more related to each other than to a randomly selected observation; that is,\nif similar values are more clustered together or more dispersed than would be expected at\nrandom.\nIn order to assess variable relationships between neighboring observations, it is\nnecessary to ﬁrst deﬁne which observations neighbor one another. A utility function in way-\nwiser, ww_build_neighbors(), can be used to do so automatically for classes from the sf\npackage, though it is often preferable for users to more thoughtfully calculate neighbors and\nprovide the resulting object to functions instead. When working with polygon geometries,"
    },
    {
      "page_no": 9,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        527.4545288085938,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n9"
    },
    {
      "page_no": 9,
      "bbox": [
        81.0,
        473.57373046875,
        522.18603515625,
        498.0328063964844
      ],
      "text": "Figure 1: Automatically calculated spatial neighbors for departments of France. Lines be-\ntween department centroids indicate a neighbor relationship."
    },
    {
      "page_no": 9,
      "bbox": [
        81.0,
        517.0698852539062,
        522.175048828125,
        555.1038208007812
      ],
      "text": "ww_build_neighbors() uses the default behavior of the poly2nb() function from spdep,\ndeﬁning neighbors as any polygons sharing at least one boundary point. We can visualize\nthis using the standard “moral statistics” data set from Guerry (1833):"
    },
    {
      "page_no": 9,
      "bbox": [
        81.00003051757812,
        568.6307983398438,
        338.7273864746094,
        620.1878662109375
      ],
      "text": "R> data(\"guerry\", package = \"waywiser\")\nR> plot(sf::st_geometry(guerry))\nR> plot(waywiser::ww_build_neighbors(guerry),\n+\nsf::st_geometry(guerry), add = TRUE)"
    },
    {
      "page_no": 9,
      "bbox": [
        81.0,
        632.5819091796875,
        522.0001831054688,
        657.619873046875
      ],
      "text": "When working with point geometries, waywiser instead uses the knearneigh() and knn2nb()\nfunctions from spdep with k = 1, returning a list of each point’s nearest neighbor."
    },
    {
      "page_no": 9,
      "bbox": [
        81.0,
        670.59375,
        401.7272644042969,
        708.601806640625
      ],
      "text": "R> plot(waywiser::ww_build_neighbors(worldclim_testing),\n+\nsf::st_geometry(worldclim_testing))\nR> plot(sf::st_geometry(worldclim_testing), add = TRUE)"
    },
    {
      "page_no": 9,
      "bbox": [
        81.0,
        721.022705078125,
        522.1531982421875,
        746.0338134765625
      ],
      "text": "For calculations, this neighbor list object must be transformed into a matrix of spatial weights,\nw.\nAnother utility function in waywiser, ww_build_weights(), provides a thin wrapper"
    },
    {
      "page_no": 10,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "10\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 10,
      "bbox": [
        81.0,
        268.7536926269531,
        522.153076171875,
        293.2117919921875
      ],
      "text": "Figure 2: Automatically calculated spatial neighbors for points from the WorldClim simula-\ntion data. Lines between points indicate a neighbor relationship."
    },
    {
      "page_no": 10,
      "bbox": [
        81.0,
        315.1208801269531,
        522.110107421875,
        339.6058349609375
      ],
      "text": "around the nb2listw() function from spdep, by default producing a row-standardized spatial\nweights matrix."
    },
    {
      "page_no": 10,
      "bbox": [
        81.0,
        357.7778015136719,
        292.90924072265625,
        368.6868896484375
      ],
      "text": "R> waywiser::ww_build_weights(guerry)"
    },
    {
      "page_no": 10,
      "bbox": [
        81.0,
        386.3058166503906,
        304.36376953125,
        464.9609375
      ],
      "text": "Characteristics of weights list object:\nNeighbour list object:\nNumber of regions: 85\nNumber of nonzero links: 420\nPercentage nonzero weights: 5.813149\nAverage number of links: 4.941176"
    },
    {
      "page_no": 10,
      "bbox": [
        81.0,
        481.1508483886719,
        247.0912322998047,
        532.7069702148438
      ],
      "text": "Weights style: W\nWeights constants summary:\nn\nnn S0\nS1\nS2\nW 85 7225 85 37.2761 347.6683"
    },
    {
      "page_no": 10,
      "bbox": [
        80.99999237060547,
        549.7728271484375,
        522.1314697265625,
        614.8789672851562
      ],
      "text": "Measures of spatial autocorrelation use this matrix in computations to estimate the rela-\ntionship between variables at neighboring locations. For waywiser, this variable is typically\nassumed to be the model residual, which we will refer to as x, so that for a given observation\nyi, xi = yi −ˆyi. By far the most popular spatial autocorrelation metric is Moran’s I (Moran\n1950), deﬁned as:"
    },
    {
      "page_no": 10,
      "bbox": [
        207.62998962402344,
        631.1433715820312,
        238.2034454345703,
        649.4469604492188
      ],
      "text": "I = n"
    },
    {
      "page_no": 10,
      "bbox": [
        229.0229949951172,
        646.0072021484375,
        239.32118225097656,
        656.9163208007812
      ],
      "text": "W"
    },
    {
      "page_no": 10,
      "bbox": [
        243.23199462890625,
        624.5361328125,
        522.0023193359375,
        661.3828125
      ],
      "text": "P n\ni=1\nP n\nj=1wij (xi −¯x) (xj −¯x)\nP n\ni=1 (xi −¯x)2\n(17)"
    },
    {
      "page_no": 10,
      "bbox": [
        80.99996948242188,
        668.5098266601562,
        522.118408203125,
        693.1238403320312
      ],
      "text": "Where n is the number of observations, W the sum of all wij, and i ̸= j. I is generally\nbounded [−1, 1] when using row-standardized weights matrices, with positive values signiﬁ-"
    },
    {
      "page_no": 10,
      "bbox": [
        80.99996948242188,
        692.8077392578125,
        512.7156372070312,
        718.5797729492188
      ],
      "text": "cantly greater than the expected value E(I) = −\n1\nn −1 indicating positive autocorrelation."
    },
    {
      "page_no": 10,
      "bbox": [
        80.99996948242188,
        721.0092163085938,
        522.19677734375,
        745.4807739257812
      ],
      "text": "Anselin (1995) later expanded upon I, presenting a method to estimate “local” I values at\neach observation rather than relying upon a single autocorrelation statistic to represent the"
    },
    {
      "page_no": 11,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n11"
    },
    {
      "page_no": 11,
      "bbox": [
        81.0,
        111.30873107910156,
        164.80369567871094,
        122.21783447265625
      ],
      "text": "entire study area:"
    },
    {
      "page_no": 11,
      "bbox": [
        221.69900512695312,
        135.4481201171875,
        380.1026611328125,
        163.77984619140625
      ],
      "text": "Ii =\n(xi −¯x)\n\u0010P N\nj=1wij (xj −¯x)\n\u0011"
    },
    {
      "page_no": 11,
      "bbox": [
        305.70599365234375,
        151.2337188720703,
        522.0023803710938,
        169.6123046875
      ],
      "text": "m2\n(18)"
    },
    {
      "page_no": 11,
      "bbox": [
        81.00003051757812,
        183.10475158691406,
        141.70730590820312,
        197.97283935546875
      ],
      "text": "Where m2 ="
    },
    {
      "page_no": 11,
      "bbox": [
        145.9310302734375,
        174.2581787109375,
        216.1861572265625,
        193.496826171875
      ],
      "text": "P n\ni=1 (xi −¯x)2"
    },
    {
      "page_no": 11,
      "bbox": [
        178.03500366210938,
        187.06373596191406,
        344.12542724609375,
        205.44232177734375
      ],
      "text": "n\n(Bivand and Wong 2018)."
    },
    {
      "page_no": 11,
      "bbox": [
        81.0,
        207.00025939941406,
        445.6958923339844,
        217.9228515625
      ],
      "text": "A less frequently used alternative to I is Geary’s c (Geary 1954), deﬁned as:"
    },
    {
      "page_no": 11,
      "bbox": [
        217.02401733398438,
        236.08885192871094,
        262.82159423828125,
        254.5328369140625
      ],
      "text": "c = n −1"
    },
    {
      "page_no": 11,
      "bbox": [
        241.51699829101562,
        251.0932159423828,
        257.27020263671875,
        262.01580810546875
      ],
      "text": "2W"
    },
    {
      "page_no": 11,
      "bbox": [
        265.2130126953125,
        229.62213134765625,
        522.0023803710938,
        266.46875
      ],
      "text": "P n\ni=1\nP n\nj=1wij (xi −xj)2\nP n\ni=1 (xi −¯x)2\n(19)"
    },
    {
      "page_no": 11,
      "bbox": [
        81.00003051757812,
        273.86419677734375,
        522.1106567382812,
        338.98382568359375
      ],
      "text": "As with Moran’s I, c stated this way provides a single index of spatial autocorrelation across\nthe entire study area. Values of c are greater than or equal to 0, with low values relative to\nthe expected value of 1 reﬂecting positive autocorrelation. Anselin (1995) extended c in a\nsimilar manner to I, providing a method to estimate local c values for each observation in a\ndata set, with further elaboration provided in Anselin (2018):"
    },
    {
      "page_no": 11,
      "bbox": [
        242.6320343017578,
        351.0801696777344,
        522.0023803710938,
        371.4580993652344
      ],
      "text": "ci =\nX n\nj=1wij (xi −xj)2\n(20)"
    },
    {
      "page_no": 11,
      "bbox": [
        81.00003051757812,
        381.8268737792969,
        522.142333984375,
        435.04681396484375
      ],
      "text": "A ﬁnal metric of local spatial autocorrelation provided in waywiser is Getis-Ord’s Gi (Getis\nand Ord 1992; Ord and Getis 1995). As with the other spatial autocorrelation metrics pro-\nvided, the function implementing Gi in waywiser is a thin wrapper over a function from spdep,\nwhich calculates Gi as a standard deviate (Bivand and Wong 2018; Getis and Ord 1996):"
    },
    {
      "page_no": 11,
      "bbox": [
        178.7100830078125,
        462.4132080078125,
        218.90171813964844,
        474.3172302246094
      ],
      "text": "Z(Gi) ="
    },
    {
      "page_no": 11,
      "bbox": [
        240.1690673828125,
        448.66033935546875,
        372.5772399902344,
        466.003173828125
      ],
      "text": "hPn\nj=1 wijxj\ni\n−\nhPn\nj=1 wij ¯xi"
    },
    {
      "page_no": 11,
      "bbox": [
        373.0740661621094,
        448.6603088378906,
        377.77642822265625,
        458.6228942871094
      ],
      "text": "i"
    },
    {
      "page_no": 11,
      "bbox": [
        223.1219940185547,
        487.5531921386719,
        231.12017822265625,
        499.4562072753906
      ],
      "text": "si"
    },
    {
      "page_no": 11,
      "bbox": [
        233.43499755859375,
        472.2053527832031,
        240.08004760742188,
        482.1679382324219
      ],
      "text": ""
    },
    {
      "page_no": 11,
      "bbox": [
        233.43499755859375,
        472.6197509765625,
        373.289306640625,
        506.0789489746094
      ],
      "text": "\n(n−1)\n\u0010Pn\nj=1 w2\nij\n\u0011\n−\n\u0010Pn\nj=1 wij\n\u00112"
    },
    {
      "page_no": 11,
      "bbox": [
        299.54998779296875,
        493.5078430175781,
        315.5071105957031,
        501.5910949707031
      ],
      "text": "n−1"
    },
    {
      "page_no": 11,
      "bbox": [
        374.9830017089844,
        472.20538330078125,
        381.6280517578125,
        482.16796875
      ],
      "text": ""
    },
    {
      "page_no": 11,
      "bbox": [
        374.9830017089844,
        489.7393798828125,
        381.6280517578125,
        506.0789794921875
      ],
      "text": ""
    },
    {
      "page_no": 11,
      "bbox": [
        381.625,
        462.2718811035156,
        522.0023803710938,
        477.96734619140625
      ],
      "text": "1/2 , i ̸= j\n(21)"
    },
    {
      "page_no": 11,
      "bbox": [
        81.00003051757812,
        525.2503662109375,
        522.0054321289062,
        545.7413330078125
      ],
      "text": "Where si =\nr\u0010\u0010Pn\nj=1 x2\nj\n\u0011\n/ (n −1)\n\u0011\n−[¯xi]2, i ̸= j and ¯xi =\n\u0010Pn\nj=1 xj\n\u0011\n/ (n −1) , i ̸= j. An"
    },
    {
      "page_no": 11,
      "bbox": [
        80.99984741210938,
        547.7579345703125,
        522.0178833007812,
        573.994873046875
      ],
      "text": "extension of this metric, G∗\ni removes the requirement that i ̸= j by including i as a neighbor\nof itself, resulting in the formula (Bivand and Wong 2018; Getis and Ord 1996):"
    },
    {
      "page_no": 11,
      "bbox": [
        191.4928436279297,
        600.6869506835938,
        233.03648376464844,
        616.6168823242188
      ],
      "text": "Z(G∗\ni ) ="
    },
    {
      "page_no": 11,
      "bbox": [
        247.44483947753906,
        589.244384765625,
        400.1201477050781,
        606.29736328125
      ],
      "text": "hPn\nj=1 wijxj\ni\n−\nh\u0010Pn\nj=1 wij\n\u0011\n¯x∗i"
    },
    {
      "page_no": 11,
      "bbox": [
        237.25599670410156,
        627.1788330078125,
        246.60211181640625,
        639.0452880859375
      ],
      "text": "s∗"
    },
    {
      "page_no": 11,
      "bbox": [
        248.9199981689453,
        612.789306640625,
        255.56504821777344,
        622.751953125
      ],
      "text": ""
    },
    {
      "page_no": 11,
      "bbox": [
        248.9199981689453,
        613.2037353515625,
        388.77435302734375,
        646.6619873046875
      ],
      "text": "\n(n−1)\n\u0010Pn\nj=1 w2\nij\n\u0011\n−\n\u0010Pn\nj=1 wij\n\u00112"
    },
    {
      "page_no": 11,
      "bbox": [
        315.0360107421875,
        634.0918579101562,
        330.9931335449219,
        642.1751098632812
      ],
      "text": "n−1"
    },
    {
      "page_no": 11,
      "bbox": [
        390.4690246582031,
        612.789306640625,
        397.11407470703125,
        622.751953125
      ],
      "text": ""
    },
    {
      "page_no": 11,
      "bbox": [
        390.4690246582031,
        630.3233642578125,
        397.11407470703125,
        646.6619873046875
      ],
      "text": ""
    },
    {
      "page_no": 11,
      "bbox": [
        397.11102294921875,
        603.0106811523438,
        522.00244140625,
        617.9191284179688
      ],
      "text": "1/2\n(22)"
    },
    {
      "page_no": 11,
      "bbox": [
        80.99993896484375,
        665.8343505859375,
        521.5000610351562,
        701.5437622070312
      ],
      "text": "Where s∗=\nr\u0010\u0010Pn\nj=1 x2\nj\n\u0011\n/n\n\u0011\n−¯x∗2 and ¯x∗=\n\u0010Pn\nj=1 xj\n\u0011\n/n. In practice, both Gi and G∗\ni\ngenerally provide similar information (Getis and Ord 1992)."
    },
    {
      "page_no": 11,
      "bbox": [
        80.99993896484375,
        707.4736938476562,
        522.1749267578125,
        746.0338134765625
      ],
      "text": "Much as with the model agreement metrics, spatial autocorrelation metrics are implemented\nin waywiser using the infrastructure provided by yardstick (Kuhn et al. 2023), with functions\npreﬁxed with ww_ for autocompletion.\nAs before, these functions take data, truth, and"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "12\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        111.30873107910156,
        522.008056640625,
        135.766845703125
      ],
      "text": "estimate as arguments, and return a tibble with .metric, .estimator, and .estimate for\ncolumns:"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        152.50881958007812,
        384.54541015625,
        190.5169219970703
      ],
      "text": "R> waywiser::ww_global_moran_i(worldclim_testing,\n+\ntruth = response,\n+\nestimate = predictions)"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        206.70584106445312,
        292.90966796875,
        258.262939453125
      ],
      "text": "# A tibble: 1 x 3\n.metric\n.estimator .estimate\n<chr>\n<chr>\n<dbl>\n1 global_moran_i standard\n0.809"
    },
    {
      "page_no": 12,
      "bbox": [
        80.99998474121094,
        273.8719787597656,
        522.0938720703125,
        326.00897216796875
      ],
      "text": "As discussed above, by default waywiser will automatically create the spatial weights matrix\nfor calculations using ww_build_weights(). To let users alter this behavior, functions for\nestimating spatial autocorrelation also accept an argument, wt, containing either the spatial\nweights matrix to use in calculations or a function to create the matrix from data:"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        342.1978759765625,
        436.0907897949219,
        393.7549743652344
      ],
      "text": "R> waywiser::ww_global_geary_c(worldclim_testing,\n+\ntruth = response,\n+\nestimate = predictions,\n+\nwt = waywiser::ww_build_weights)"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        409.9438781738281,
        292.90966796875,
        461.5009765625
      ],
      "text": "# A tibble: 1 x 3\n.metric\n.estimator .estimate\n<chr>\n<chr>\n<dbl>\n1 global_geary_c standard\n0.159"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        477.1099853515625,
        522.0172119140625,
        502.1479797363281
      ],
      "text": "As the _vec variants of these functions do not take an argument for data, waywiser cannot\nautomatically create a spatial weights matrix, and one must be provided to the wt argument:"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        518.337890625,
        396.0,
        569.89404296875
      ],
      "text": "R> waywiser::ww_global_geary_c_vec(\n+\ntruth = worldclim_testing$response,\n+\nestimate = worldclim_testing$predictions,\n+\nwt = waywiser::ww_build_weights(worldclim_testing))"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        586.083984375,
        155.4546356201172,
        596.9930419921875
      ],
      "text": "[1] 0.1593391"
    },
    {
      "page_no": 12,
      "bbox": [
        81.0,
        612.60205078125,
        522.1968383789062,
        745.48095703125
      ],
      "text": "As previously mentioned, functions from waywiser are both type- and size-stable, guaranteeing\nthat the outputs from a function will always be of a known data type and of known dimensions.\nFor model agreement metrics and global autocorrelation statistics, this means that the output\nfrom waywiser will always be a tibble with one row (or, for grouped data frames, one row\nper group). This behavior changes for local autocorrelation metrics, however: rather than\nreturning a single row, local autocorrelation functions return a tibble with as many rows as\nthere are observations in data (or values in truth and estimate, for the _vec variants). These\nestimates are ordered in the same order as the input data frame, meaning that the outputs\nfrom these functions can be used with cbind() to associate an autocorrelation estimate with\nits corresponding observation."
    },
    {
      "page_no": 13,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n13"
    },
    {
      "page_no": 13,
      "bbox": [
        173.1202392578125,
        232.57713317871094,
        385.1547546386719,
        244.32864379882812
      ],
      "text": "120°W\n 60°W\n  0°\n 60°E\n120°E"
    },
    {
      "page_no": 13,
      "bbox": [
        461.96673583984375,
        197.06459045410156,
        466.2003173828125,
        207.52671813964844
      ],
      "text": "0"
    },
    {
      "page_no": 13,
      "bbox": [
        461.96673583984375,
        183.3502960205078,
        470.43389892578125,
        193.8124237060547
      ],
      "text": "25"
    },
    {
      "page_no": 13,
      "bbox": [
        461.96673583984375,
        169.6275177001953,
        470.43389892578125,
        180.0896453857422
      ],
      "text": "50"
    },
    {
      "page_no": 13,
      "bbox": [
        461.96673583984375,
        155.91322326660156,
        470.43389892578125,
        166.37535095214844
      ],
      "text": "75"
    },
    {
      "page_no": 13,
      "bbox": [
        445.73968505859375,
        130.8662109375,
        475.64886474609375,
        144.8157196044922
      ],
      "text": "Local I"
    },
    {
      "page_no": 13,
      "bbox": [
        173.1202392578125,
        380.22802734375,
        385.1547546386719,
        391.9795227050781
      ],
      "text": "120°W\n 60°W\n  0°\n 60°E\n120°E"
    },
    {
      "page_no": 13,
      "bbox": [
        459.71630859375,
        297.21038818359375,
        468.1834716796875,
        356.1929016113281
      ],
      "text": "0\n10\n20\n30\n40\n50"
    },
    {
      "page_no": 13,
      "bbox": [
        443.48919677734375,
        278.5171203613281,
        477.9061279296875,
        292.46661376953125
      ],
      "text": "Local C"
    },
    {
      "page_no": 13,
      "bbox": [
        81.0,
        404.7322082519531,
        522.111083984375,
        429.2038269042969
      ],
      "text": "Figure 3: Local I and c values for model residuals from a linear model ﬁt to the WorldClim\nsimulation data."
    },
    {
      "page_no": 13,
      "bbox": [
        81.00000762939453,
        455.8387756347656,
        441.8180847167969,
        493.84588623046875
      ],
      "text": "R> waywiser::ww_local_moran_i(worldclim_testing,\n+\ntruth = response,\n+\nestimate = predictions) |> head(2)"
    },
    {
      "page_no": 13,
      "bbox": [
        81.00000762939453,
        525.3748168945312,
        287.1824035644531,
        590.4808959960938
      ],
      "text": "# A tibble: 2 x 3\n.metric\n.estimator .estimate\n<chr>\n<chr>\n<dbl>\n1 local_moran_i standard\n0.290\n2 local_moran_i standard\n4.00"
    },
    {
      "page_no": 13,
      "bbox": [
        81.00000762939453,
        621.4567260742188,
        522.1859741210938,
        713.6608276367188
      ],
      "text": "Autocorrelation metrics are useful for informing qualitative assessments of model performance,\nwith local statistics in particular being more useful for data exploration tasks than inference\n(Anselin 2018). For instance, when evaluating our linear model ﬁt to simulation data, visually\ninspecting local I statistics (plotted in Figure 3 using ggplot2 (Wickham 2016) and patchwork\n(Pedersen 2022)) indicate notable clustering of residuals in southern India. Local c statistics\nmeanwhile highlight the same location as an area of concern, but also highlight several other\nregions in southeastern Asia, as well as areas in western Africa and South America."
    },
    {
      "page_no": 13,
      "bbox": [
        81.00003051757812,
        721.022705078125,
        522.2077026367188,
        745.4808349609375
      ],
      "text": "The presence of spatial autocorrelation in model residuals suggests a misspeciﬁcation in the\nunderlying model. Similarities between regions exhibiting residual autocorrelation may help"
    },
    {
      "page_no": 14,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "14\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 14,
      "bbox": [
        81.0,
        111.30873107910156,
        379.4403076171875,
        122.21783447265625
      ],
      "text": "to identify missing predictors, or to explain model weaknesses."
    },
    {
      "page_no": 14,
      "bbox": [
        211.74000549316406,
        146.5827178955078,
        391.32568359375,
        160.92892456054688
      ],
      "text": "4. Multi-scale assessment"
    },
    {
      "page_no": 14,
      "bbox": [
        81.0,
        172.75672912597656,
        522.1967163085938,
        292.05889892578125
      ],
      "text": "Spatial models are often used to predict the most ﬁne-grain scale of interest, with predictions\nthen aggregated to broader scales as necessary. For instance, models of forest aboveground\nbiomass are often used to predict biomass at individual measurement plots, and then ag-\ngregated to provide biomass estimates at regional or landscape scales (Johnson et al. 2022;\nBlackard et al. 2008). Similarly, models of nematode biomass are used to estimate biomass\nat ﬁne-grained resolutions, with predictions then aggregated to produce global estimates\n(van den Hoogen et al. 2019). Unfortunately, model performance estimates cannot be assumed\nto be consistent across spatial scales (Nelson et al. 2009). As a result, separate performance\nmetrics must be calculated for each relevant scale of interest."
    },
    {
      "page_no": 14,
      "bbox": [
        81.00003051757812,
        297.9338073730469,
        522.175048828125,
        457.88494873046875
      ],
      "text": "To this end, Riemann et al. (2010) introduced an assessment protocol for evaluating model per-\nformance across multiple scales of aggregation. This method requires calculating multiple per-\nformance estimates from model predictions and measured values aggregated to multiple grids\nof regular polygons, in order to assess how model performance varies spatially and across mul-\ntiple scales. This approach is implemented in waywiser as the function ww_multi_scale().\nAs with the model assessment functions already described, this function accepts the argu-\nments data, truth, and estimate, as well as a new argument metrics which accepts lists of\nmetric functions (or outputs from yardstick::metric_set()) to calculate at each scale of\naggregation. Additional arguments can be passed via ... to sf::st_make_grid() in order\nto assess predictions aggregated to a grid of evenly spaced regular polygons. For example,\nthe following code evaluates the RMSE and Willmott’s d1 values for the WorldClim model\naggregated using a 2-by-2, 5-by-5, and 10-by-10 grid:"
    },
    {
      "page_no": 14,
      "bbox": [
        81.00003051757812,
        475.64788818359375,
        436.09088134765625,
        554.302978515625
      ],
      "text": "R> (multi_scale_output <- waywiser::ww_multi_scale(\n+\nworldclim_testing,\n+\ntruth = response,\n+\nestimate = predictions,\n+\nmetrics = list(yardstick::rmse, waywiser::ww_willmott_d1),\n+\nn = c(2, 5, 10)))"
    },
    {
      "page_no": 14,
      "bbox": [
        81.00003051757812,
        571.512939453125,
        510.5453796386719,
        690.8159790039062
      ],
      "text": "# A tibble: 6 x 6\n.metric\n.estimator .estimate .grid_args\n.grid\n.notes\n<chr>\n<chr>\n<dbl> <list>\n<list>\n<list>\n1 rmse\nstandard\n0.0299 <tibble [1 x 1]> <sf [4 x 5]>\n<tibble>\n2 willmott_d1 standard\n0.586\n<tibble [1 x 1]> <sf [4 x 5]>\n<tibble>\n3 rmse\nstandard\n0.0650 <tibble [1 x 1]> <sf [25 x 5]>\n<tibble>\n4 willmott_d1 standard\n0.759\n<tibble [1 x 1]> <sf [25 x 5]>\n<tibble>\n5 rmse\nstandard\n0.0761 <tibble [1 x 1]> <sf [100 x 5]> <tibble>\n6 willmott_d1 standard\n0.810\n<tibble [1 x 1]> <sf [100 x 5]> <tibble>"
    },
    {
      "page_no": 14,
      "bbox": [
        81.00003051757812,
        707.446044921875,
        522.21875,
        745.48095703125
      ],
      "text": "Note that this function requires data be an sf object with point geometries from the sf\npackage, in order to ensure that the data’s coordinate reference system and units are properly\nhandled when assigning observations to each grid cell."
    },
    {
      "page_no": 15,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n15"
    },
    {
      "page_no": 15,
      "bbox": [
        80.99998474121094,
        111.30873107910156,
        522.2186889648438,
        176.41485595703125
      ],
      "text": "The output from ww_multi_scale() will typically have one row for each combination of\nmetric and aggregation level. As with functions for model agreement metrics, however, if\ndata is a grouped data frame produced by group_by(), this function will instead calculate\nmetrics for each group independently, resulting in an output with one row per combination\nof unique grouping, metric, and aggregation:"
    },
    {
      "page_no": 15,
      "bbox": [
        81.0,
        195.09280395507812,
        344.4546203613281,
        273.7479248046875
      ],
      "text": "R> waywiser::ww_multi_scale(\n+\ndplyr::group_by(worldclim_testing, group),\n+\ntruth = response,\n+\nestimate = predictions,\n+\nmetrics = list(waywiser::ww_willmott_d1),\n+\nn = 2)"
    },
    {
      "page_no": 15,
      "bbox": [
        81.0,
        291.8728332519531,
        533.4545288085938,
        356.97796630859375
      ],
      "text": "# A tibble: 2 x 7\ngroup .metric\n.estimator .estimate .grid_args\n.grid\n.notes\n<int> <chr>\n<chr>\n<dbl> <list>\n<list>\n<list>\n1\n1 willmott_d1 standard\n0.776 <tibble [1 x 1]> <sf [8 x 6]> <tibble>\n2\n2 willmott_d1 standard\n0.408 <tibble [1 x 1]> <sf [8 x 6]> <tibble>"
    },
    {
      "page_no": 15,
      "bbox": [
        80.99996948242188,
        374.5498352050781,
        522.96728515625,
        439.65594482421875
      ],
      "text": "In addition to the familiar .metric, .estimator, and .estimate columns, ww_multi_scale()\nreturns three new columns. The .grid_args column is a list of tibbles from the tibble pack-\nage (Müller and Wickham 2022), containing the arguments used to construct the grid via\nsf::st_make_grid(). This column can be unpacked, for example via the unnest() function\nin tidyr (Wickham et al. 2023b), to add these arguments as columns to the output table:"
    },
    {
      "page_no": 15,
      "bbox": [
        81.0,
        458.3338928222656,
        355.9091491699219,
        469.24298095703125
      ],
      "text": "R> tidyr::unnest(multi_scale_output, .grid_args)"
    },
    {
      "page_no": 15,
      "bbox": [
        81.0,
        487.3678894042969,
        493.3636169433594,
        606.6710205078125
      ],
      "text": "# A tibble: 6 x 6\n.metric\n.estimator .estimate\nn .grid\n.notes\n<chr>\n<chr>\n<dbl> <dbl> <list>\n<list>\n1 rmse\nstandard\n0.0299\n2 <sf [4 x 5]>\n<tibble [0 x 2]>\n2 willmott_d1 standard\n0.586\n2 <sf [4 x 5]>\n<tibble [0 x 2]>\n3 rmse\nstandard\n0.0650\n5 <sf [25 x 5]>\n<tibble [0 x 2]>\n4 willmott_d1 standard\n0.759\n5 <sf [25 x 5]>\n<tibble [0 x 2]>\n5 rmse\nstandard\n0.0761\n10 <sf [100 x 5]> <tibble [0 x 2]>\n6 willmott_d1 standard\n0.810\n10 <sf [100 x 5]> <tibble [0 x 2]>"
    },
    {
      "page_no": 15,
      "bbox": [
        81.0,
        624.2428588867188,
        455.640380859375,
        635.1519775390625
      ],
      "text": "This is particularly convenient when visualizing the outputs from this process:"
    },
    {
      "page_no": 15,
      "bbox": [
        81.0,
        653.8299560546875,
        470.4544372558594,
        746.0339965820312
      ],
      "text": "R> tidyr::unnest(multi_scale_output, .grid_args) |>\n+\nggplot2::ggplot(ggplot2::aes(n^2, .estimate, color = .metric)) +\n+\nggplot2::geom_line() +\n+\nggplot2::scale_x_continuous(\n+\nname = \"Number of grid cells\",\n+\nbreaks = (c(2, 5, 10)^2)) +\n+\nggplot2::facet_wrap(~ .metric)"
    },
    {
      "page_no": 16,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "16\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 16,
      "bbox": [
        208.99151611328125,
        106.6985855102539,
        377.82623291015625,
        116.79776000976562
      ],
      "text": "rmse\nwillmott d1"
    },
    {
      "page_no": 16,
      "bbox": [
        135.39596557617188,
        315.2204284667969,
        427.98736572265625,
        332.2929382324219
      ],
      "text": "4\n25\n100\n4\n25\n100\n0.0"
    },
    {
      "page_no": 16,
      "bbox": [
        135.39596557617188,
        267.02984619140625,
        144.68394470214844,
        276.2109069824219
      ],
      "text": "0.2"
    },
    {
      "page_no": 16,
      "bbox": [
        135.39596557617188,
        218.84593200683594,
        144.68394470214844,
        228.02700805664062
      ],
      "text": "0.4"
    },
    {
      "page_no": 16,
      "bbox": [
        135.39596557617188,
        170.6553497314453,
        144.68394470214844,
        179.83642578125
      ],
      "text": "0.6"
    },
    {
      "page_no": 16,
      "bbox": [
        135.39596557617188,
        122.471435546875,
        144.68394470214844,
        131.6525115966797
      ],
      "text": "0.8"
    },
    {
      "page_no": 16,
      "bbox": [
        249.6648406982422,
        330.49212646484375,
        327.0276794433594,
        342.4275207519531
      ],
      "text": "Number of grid cells"
    },
    {
      "page_no": 16,
      "bbox": [
        122.3159408569336,
        201.18475341796875,
        134.25132751464844,
        236.42626953125
      ],
      "text": ".estimate"
    },
    {
      "page_no": 16,
      "bbox": [
        436.0325012207031,
        202.26119995117188,
        460.20794677734375,
        213.2784881591797
      ],
      "text": ".metric"
    },
    {
      "page_no": 16,
      "bbox": [
        448.8486022949219,
        215.87579345703125,
        478.92364501953125,
        232.92556762695312
      ],
      "text": "rmse\nwillmott_d1"
    },
    {
      "page_no": 16,
      "bbox": [
        81.0,
        357.0481872558594,
        522.1857299804688,
        408.6188049316406
      ],
      "text": "Figure 4: RMSE and Willmott d1 estimates for a linear model ﬁt to the WorldClim simu-\nlation data, aggregated to multiple spatial scales. The \"number of grid cells\" refers to the\nnumber of partitions data was aggregated into; more grid cells indicate a ﬁner-grained level\nof aggregation."
    },
    {
      "page_no": 16,
      "bbox": [
        81.0,
        428.5207214355469,
        522.1859130859375,
        480.6298828125
      ],
      "text": "The .grid column meanwhile is a list of sf objects, each containing the actual polygons used\nto aggregate predictions and observed values before calculating metrics. These objects also\ncontain the aggregated values of .truth and .estimate, as well as a count of the number of\nnon-missing observations for each of .truth and .estimate contained in the polygon."
    },
    {
      "page_no": 16,
      "bbox": [
        81.0,
        494.9598083496094,
        264.2729187011719,
        505.868896484375
      ],
      "text": "R> multi_scale_output$.grid[[2]]"
    },
    {
      "page_no": 16,
      "bbox": [
        81.0,
        520.1978759765625,
        516.2725830078125,
        720.7958984375
      ],
      "text": "Simple feature collection with 4 features and 4 fields\nGeometry type: POLYGON\nDimension:\nXY\nBounding box:\nxmin: -178.6972 ymin: -59.39802 xmax: 179.6074 ymax: 83.85131\nGeodetic CRS:\n+proj=longlat +datum=WGS84 +no_defs\n.truth .truth_count .estimate .estimate_count\n1 0.3221379\n790 0.3613896\n790\n2 0.4078587\n1191 0.3860225\n1191\n3 0.3148534\n10 0.3539468\n10\n4 0.4041676\n9 0.4096796\n9\ngeometry\n1 POLYGON ((-178.6972 -59.398...\n2 POLYGON ((0.4550702 -59.398...\n3 POLYGON ((-178.6972 12.2266...\n4 POLYGON ((0.4550702 12.2266..."
    },
    {
      "page_no": 16,
      "bbox": [
        81.0,
        734.5717163085938,
        410.10577392578125,
        745.4808349609375
      ],
      "text": "This data is often useful to visualize the spatial distribution of error:"
    },
    {
      "page_no": 17,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n17"
    },
    {
      "page_no": 17,
      "bbox": [
        170.7979278564453,
        221.72132873535156,
        363.4923400878906,
        230.96763610839844
      ],
      "text": "120°W\n 60°W\n  0°\n 60°E\n120°E"
    },
    {
      "page_no": 17,
      "bbox": [
        430.5196228027344,
        178.36892700195312,
        442.3460998535156,
        186.60073852539062
      ],
      "text": "−0.1"
    },
    {
      "page_no": 17,
      "bbox": [
        430.5196228027344,
        167.71139526367188,
        438.8472900390625,
        175.94320678710938
      ],
      "text": "0.0"
    },
    {
      "page_no": 17,
      "bbox": [
        430.5196228027344,
        157.05386352539062,
        438.8472900390625,
        165.28567504882812
      ],
      "text": "0.1"
    },
    {
      "page_no": 17,
      "bbox": [
        417.75189208984375,
        133.00616455078125,
        477.5911865234375,
        154.63478088378906
      ],
      "text": "0.2\n.truth − .estimate"
    },
    {
      "page_no": 17,
      "bbox": [
        81.62100219726562,
        244.3496856689453,
        521.5523071289062,
        255.2587890625
      ],
      "text": "Figure 5: Model errors after aggregating predictions and observed values to a 10-by-10 grid."
    },
    {
      "page_no": 17,
      "bbox": [
        81.0,
        277.4887390136719,
        470.4544372558594,
        342.5938720703125
      ],
      "text": "R> multi_scale_output$.grid[[6]] |>\n+\ntidyr::drop_na() |>\n+\nggplot2::ggplot(ggplot2::aes(fill = .truth - .estimate)) +\n+\nggplot2::geom_sf() +\n+\nggplot2::scale_fill_distiller(palette = \"YlOrRd\", direction = 1)"
    },
    {
      "page_no": 17,
      "bbox": [
        81.0,
        359.2417297363281,
        522.154541015625,
        383.6998291015625
      ],
      "text": "The ﬁnal .notes column contains diagnostic information, including information on which (if\nany) observations fell outside the boundaries of the grid."
    },
    {
      "page_no": 17,
      "bbox": [
        81.0,
        389.57373046875,
        522.2077026367188,
        481.7788391113281
      ],
      "text": "When not all use cases for a model are known, this approach of systematically aggregating\npredictions and observed values to grids of regular polygons can help provide useful perfor-\nmance estimates for future users who will aggregate predictions to their boundaries of interest.\nIf future use cases are well understood, however, it is often more useful to assess model per-\nformance when aggregating to those boundaries directly; for instance, it often makes sense to\nevaluate model performance when aggregating predictions to administrative boundaries such\nas along town or regional polygons, in addition to other assessments."
    },
    {
      "page_no": 17,
      "bbox": [
        80.99998474121094,
        487.6527404785156,
        522.251220703125,
        525.6598510742188
      ],
      "text": "For this reason, ww_multi_scale() allows users to provide their own pre-computed polygons\nto the grids argument.\nPredictions and observed values will then be aggregated to the\nprovided polygons. Other than this, the function interface and returned values are identical:"
    },
    {
      "page_no": 17,
      "bbox": [
        80.99998474121094,
        543.413818359375,
        436.0908203125,
        622.0689086914062
      ],
      "text": "R> waywiser::ww_multi_scale(\n+\nworldclim_testing,\n+\ntruth = response,\n+\nestimate = predictions,\n+\nmetrics = list(yardstick::rmse, waywiser::ww_willmott_d1),\n+\ngrids = list(sf::st_make_grid(worldclim_testing)))"
    },
    {
      "page_no": 17,
      "bbox": [
        80.99998474121094,
        639.268798828125,
        510.5452880859375,
        704.3748779296875
      ],
      "text": "# A tibble: 2 x 6\n.metric\n.estimator .estimate .grid_args\n.grid\n.notes\n<chr>\n<chr>\n<dbl> <list>\n<list>\n<list>\n1 rmse\nstandard\n0.0761 <tibble [0 x 0]> <sf [100 x 5]> <tibble>\n2 willmott_d1 standard\n0.810\n<tibble [0 x 0]> <sf [100 x 5]> <tibble>"
    },
    {
      "page_no": 17,
      "bbox": [
        80.99996948242188,
        721.022705078125,
        522.02587890625,
        745.4808349609375
      ],
      "text": "Note that when using pre-computed polygons .grid_args is a tibble with 0 rows, as no\narguments were passed to create the grid."
    },
    {
      "page_no": 18,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "18\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 18,
      "bbox": [
        81.0,
        111.30873107910156,
        522.1749877929688,
        271.81195068359375
      ],
      "text": "A challenge with requiring sf objects for input data is that it requires all observations\nbe loaded into memory before any aggregations can be calculated, which poses problems\nfor modeling eﬀorts with large numbers of relatively small observation units such as high-\nresolution landscape or global models. Such eﬀorts typically rely on raster formats for ef-\nﬁciency, and avoid transforming rasters into vector representations whenever possible. As\nsuch, ww_multi_scale() can also be used to calculate performance metrics using raster in-\nputs. If data is NULL or missing, users can provide SpatRaster objects from the terra package\n(Hijmans 2023) to both truth and estimate in order to perform a multi-scale assessment.\nAggregation for this method is performed using the exactextractr package (Baston 2022) for\nmemory and computational eﬃciency. Other than the slightly diﬀerent interface and using ex-\nactextractr for aggregation, this method of ww_multi_scale() works identically and returns\nan identical output to the sf method."
    },
    {
      "page_no": 18,
      "bbox": [
        81.0,
        297.4638366699219,
        430.36358642578125,
        389.66796875
      ],
      "text": "R> r1 <- matrix(nrow = 10, ncol = 10)\nR> r1[] <- 1\nR> r1 <- terra::rast(r1)\nR> r2 <- matrix(nrow = 10, ncol = 10)\nR> r2[] <- 2\nR> r2 <- terra::rast(r2)\nR> waywiser::ww_multi_scale(truth = r1, estimate = r2, n = 1)"
    },
    {
      "page_no": 18,
      "bbox": [
        81.0,
        415.31988525390625,
        521.9998779296875,
        480.4259948730469
      ],
      "text": "# A tibble: 2 x 6\n.metric .estimator .estimate .grid_args\n.grid\n.notes\n<chr>\n<chr>\n<dbl> <list>\n<list>\n<list>\n1 rmse\nstandard\n1 <tibble [1 x 1]> <sf [1 x 5]> <tibble [0 x 2]>\n2 mae\nstandard\n1 <tibble [1 x 1]> <sf [1 x 5]> <tibble [0 x 2]>"
    },
    {
      "page_no": 18,
      "bbox": [
        219.47799682617188,
        527.2398071289062,
        383.56976318359375,
        541.5859985351562
      ],
      "text": "5. Area of applicability"
    },
    {
      "page_no": 18,
      "bbox": [
        81.0,
        554.3030395507812,
        522.207763671875,
        687.1819458007812
      ],
      "text": "A ﬁnal set of functions in waywiser aim to help users assess if their model can be trusted to\ngeneralize to new observations. By calculating how similar new observations are in predictor\nspace to the data used to train a model, it is possible to determine if new observations are\nwithin the “applicability domain” of a model and are likely to be well-represented by the\nmodel’s predictions (Netzeva et al. 2005). While these methods are not explicitly spatial, the\npresence of spatial autocorrelation in model predictors makes it more likely that using a model\nto extrapolate geographically will also require the model to extrapolate in predictor space,\nproducing worse predictions as the extrapolation distance increases. As such, these techniques\nare particularly useful when predicting into regions with little data for model training and\nassessment."
    },
    {
      "page_no": 18,
      "bbox": [
        81.00000762939453,
        693.923828125,
        522.2186889648438,
        745.48095703125
      ],
      "text": "Meyer and Pebesma (2021) introduce a new applicability domain methodology built upon a\n“dissimilarity index”, DI, representing the Euclidean distance in predictor space between a\npoint and its nearest neighbor scaled by the average such distance in the data used to train\na model. Using variables which have been scaled and centered, then weighted by variable"
    },
    {
      "page_no": 19,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n19"
    },
    {
      "page_no": 19,
      "bbox": [
        81.0,
        111.29524230957031,
        385.1935119628906,
        122.21783447265625
      ],
      "text": "importance scores, the DI for an observation k is calculated as:"
    },
    {
      "page_no": 19,
      "bbox": [
        235.61199951171875,
        137.14312744140625,
        366.88812255859375,
        158.5758056640625
      ],
      "text": "d (a, b) =\nqX p\ni=1 (ai −bi)2"
    },
    {
      "page_no": 19,
      "bbox": [
        256.0920104980469,
        163.27125549316406,
        349.24169921875,
        181.63726806640625
      ],
      "text": "dk = arg min\nz\nd(k, z)"
    },
    {
      "page_no": 19,
      "bbox": [
        247.64004516601562,
        183.92726135253906,
        292.7165222167969,
        204.0068359375
      ],
      "text": "DIk = dk"
    },
    {
      "page_no": 19,
      "bbox": [
        285.1910095214844,
        196.85768127441406,
        292.5755615234375,
        210.63232421875
      ],
      "text": "¯d"
    },
    {
      "page_no": 19,
      "bbox": [
        502.60601806640625,
        168.3377227783203,
        522.0023803710938,
        179.246826171875
      ],
      "text": "(23)"
    },
    {
      "page_no": 19,
      "bbox": [
        81.0,
        220.7382354736328,
        522.0886840820312,
        258.75885009765625
      ],
      "text": "Where p is the number of predictors used in ﬁtting a model, ai and bi the scaled and weighted\npredictor values for observations a and b, z observations in the data used to train the model,\nand ¯d the mean d for all pairs of observations in the data used to train the model."
    },
    {
      "page_no": 19,
      "bbox": [
        80.99996948242188,
        264.98724365234375,
        522.207763671875,
        357.204833984375
      ],
      "text": "These DI values are useful in their own right to characterize the similarity of new observations\nto those used to train a model, and increasing DI often correlates with increasing prediction\nerror (Meyer and Pebesma 2021). Meyer and Pebesma (2021) also propose a thresholding\nmethod to calculate a boolean “area of applicability” (AOA), deﬁning points with a DIk\ngreater than the 75th percentile DI value plus 1.5 times the IQR of DI values in training\ndata as beyond the model’s AOA, and therefore likely to have greater prediction error than\nreported for test set observations."
    },
    {
      "page_no": 19,
      "bbox": [
        80.99996948242188,
        363.4198913574219,
        523.7929077148438,
        469.20086669921875
      ],
      "text": "Functions to calculate DI and AOA were ﬁrst implemented in CAST (Meyer et al. 2023),\nwith a focus on supporting models ﬁt using the caret modeling framework (Kuhn 2022a). In\nwaywiser, the ww_area_of_applicability() function provides a framework-agnostic inter-\nface for calculating DI and AOA, with additional support for workﬂows using the tidymodels\nframework (Section 6) (Kuhn and Silge 2022). The interface of ww_area_of_applicability()\nis inspired by the applicable package (Gotti and Kuhn 2022), and mimics common model-\nﬁtting functions such as lm(). A standard call involves providing the model formula used,\ntraining and testing data sets, and variable importance scores:"
    },
    {
      "page_no": 19,
      "bbox": [
        80.99996948242188,
        490.65380859375,
        361.6363830566406,
        555.7598876953125
      ],
      "text": "R> (aoa <- waywiser::ww_area_of_applicability(\n+\nformula(worldclim_model),\n+\nworldclim_training,\n+\ntesting = worldclim_testing,\n+\nimportance = vip::vi_model(worldclim_model)))"
    },
    {
      "page_no": 19,
      "bbox": [
        80.99996948242188,
        576.660888671875,
        264.27288818359375,
        628.2178955078125
      ],
      "text": "# Predictors:\n4\nArea-of-applicability threshold:\n0.103787"
    },
    {
      "page_no": 19,
      "bbox": [
        80.99996948242188,
        648.5647583007812,
        522.1749877929688,
        673.0238647460938
      ],
      "text": "An equivalent call removes the formula argument, and instead passes the training and testing\ndata, subset to include only the variables used to ﬁt the model:"
    },
    {
      "page_no": 19,
      "bbox": [
        80.99996948242188,
        694.4768676757812,
        378.81817626953125,
        746.033935546875
      ],
      "text": "R> waywiser::ww_area_of_applicability(\n+\nas.data.frame(worldclim_training)[1:4],\n+\ntesting = as.data.frame(worldclim_testing)[1:4],\n+\nimportance = vip::vi_model(worldclim_model))"
    },
    {
      "page_no": 20,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "20\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 20,
      "bbox": [
        81.0,
        111.86178588867188,
        264.2729187011719,
        163.4179229736328
      ],
      "text": "# Predictors:\n4\nArea-of-applicability threshold:\n0.103787"
    },
    {
      "page_no": 20,
      "bbox": [
        81.0,
        175.76075744628906,
        522.1859741210938,
        240.86688232421875
      ],
      "text": "As demonstrated, ww_area_of_applicability() natively accepts variable importance scores\nreturned by the vip package (Greenwell and Boehmke 2020). The importance argument will\nalso accept any data frame with columns named term and estimate, containing (respectively)\nthe variable name and importance estimate, allowing the use of any method for calculating\nvariable importance scores."
    },
    {
      "page_no": 20,
      "bbox": [
        80.99996948242188,
        246.40090942382812,
        522.129638671875,
        339.1849365234375
      ],
      "text": "Unlike other functions in waywiser, the output from ww_area_of_applicability() is a\ncustom class “ww_area_of_applicability” which inherits from the “hardhat_model” and\n“hardhat_scalar” classes from the hardhat package. This class can be thought of as being\na model object, like that returned by lm(), and as such implements a predict() method\nfor calculating DI and AOA for new observations. This function returns a tibble with two\ncolumns: di, containing DI values for each new observation, and aoa, a boolean indicating\nif the observation is within (TRUE) or outside of (FALSE) the AOA:"
    },
    {
      "page_no": 20,
      "bbox": [
        80.99993896484375,
        352.0798645019531,
        275.7273864746094,
        362.98895263671875
      ],
      "text": "R> predict(aoa, worldclim_testing)"
    },
    {
      "page_no": 20,
      "bbox": [
        80.99993896484375,
        375.8848571777344,
        229.90921020507812,
        562.9330444335938
      ],
      "text": "# A tibble: 2,000 x 2\ndi aoa\n<dbl> <lgl>\n1 0.0676 TRUE\n2 0.109\nFALSE\n3 0.0264 TRUE\n4 0.0382 TRUE\n5 0.0398 TRUE\n6 0.0243 TRUE\n7 0\nTRUE\n8 0.0462 TRUE\n9 0.0285 TRUE\n10 0.0178 TRUE\n# ... with 1,990 more rows"
    },
    {
      "page_no": 20,
      "bbox": [
        80.99994659423828,
        575.27587890625,
        522.0569458007812,
        626.8319702148438
      ],
      "text": "Observations with missing values will have an NA for both di and aoa, guaranteeing that the\nnumber of rows returned will always match the number of rows in the newdata object. As\nsuch, these predictions can be safely combined with predictor values via cbind() and similar\nfunctions, making visualization and analysis easier."
    },
    {
      "page_no": 20,
      "bbox": [
        80.99996948242188,
        640.2799682617188,
        493.36346435546875,
        746.0339965820312
      ],
      "text": "R> library(\"patchwork\")\nR> (cbind(worldclim_testing, predict(aoa, worldclim_testing)) |>\n+\nggplot2::ggplot(ggplot2::aes(color = di)) +\n+\nggplot2::geom_sf(alpha = 0.7) +\n+\nggplot2::scale_color_distiller(palette = \"Reds\", direction = 1)) /\n+\n(cbind(worldclim_testing, predict(aoa, worldclim_testing)) |>\n+\nggplot2::ggplot(ggplot2::aes(color = aoa)) +\n+\nggplot2::geom_sf(alpha = 0.7))"
    },
    {
      "page_no": 21,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n21"
    },
    {
      "page_no": 21,
      "bbox": [
        172.31683349609375,
        230.83111572265625,
        381.3564758300781,
        242.41664123535156
      ],
      "text": "120°W\n 60°W\n  0°\n 60°E\n120°E"
    },
    {
      "page_no": 21,
      "bbox": [
        461.23724365234375,
        196.82110595703125,
        471.6717529296875,
        207.13546752929688
      ],
      "text": "0.0"
    },
    {
      "page_no": 21,
      "bbox": [
        461.23724365234375,
        184.6851043701172,
        471.6717529296875,
        194.9994659423828
      ],
      "text": "0.1"
    },
    {
      "page_no": 21,
      "bbox": [
        461.23724365234375,
        172.54908752441406,
        471.6717529296875,
        182.8634490966797
      ],
      "text": "0.2"
    },
    {
      "page_no": 21,
      "bbox": [
        461.23724365234375,
        160.4130859375,
        471.6717529296875,
        170.72744750976562
      ],
      "text": "0.3"
    },
    {
      "page_no": 21,
      "bbox": [
        461.23724365234375,
        148.26873779296875,
        471.6717529296875,
        158.58309936523438
      ],
      "text": "0.4"
    },
    {
      "page_no": 21,
      "bbox": [
        445.24774169921875,
        130.55682373046875,
        453.0347900390625,
        144.30931091308594
      ],
      "text": "di"
    },
    {
      "page_no": 21,
      "bbox": [
        172.31683349609375,
        376.3965148925781,
        381.3564758300781,
        387.9820251464844
      ],
      "text": "120°W\n 60°W\n  0°\n 60°E\n120°E"
    },
    {
      "page_no": 21,
      "bbox": [
        438.87530517578125,
        292.5704650878906,
        455.5704650878906,
        306.32293701171875
      ],
      "text": "aoa"
    },
    {
      "page_no": 21,
      "bbox": [
        454.86480712890625,
        309.5733947753906,
        478.0458068847656,
        330.8560485839844
      ],
      "text": "FALSE\nTRUE"
    },
    {
      "page_no": 21,
      "bbox": [
        80.99998474121094,
        400.76519775390625,
        522.1796264648438,
        438.78680419921875
      ],
      "text": "Figure 6: DI and AOA for for a linear model ﬁt to the WorldClim simulation data. Areas\nwith a higher DI are poorly represented in the data used to train the model, and are likely\nto fall outside the model’s AOA (‘FALSE‘ in the lower graph)."
    },
    {
      "page_no": 21,
      "bbox": [
        80.99998474121094,
        504.3987121582031,
        522.1533203125,
        583.0538330078125
      ],
      "text": "Finally, ww_area_of_applicability() also supports calculating the AOA using data splits\nfrom cross-validation, as opposed to distinct training and testing sets. Any rset object, such\nas those produced by the rsample or spatialsample packages (Frick et al. 2022; Mahoney and\nSilge 2023), can be used to calculate the AOA. This method calculates dk as the distance\nbetween a point in the assessment set and its nearest neighbor in the analysis set. A full\ndemonstration is included in Section 6."
    },
    {
      "page_no": 21,
      "bbox": [
        81.00006103515625,
        599.0529174804688,
        522.1725463867188,
        745.4807739257812
      ],
      "text": "When using cross-validation splits in the place of test set data, waywiser diﬀers slightly\nfrom the implementation in CAST. Whereas CAST performs scaling and centering using all\nobservations, and calculates ¯d as the mean distance between all observations across all folds,\nwaywiser rescales the analysis and assessment sets for each fold of cross validation separately,\nand calculates a per-fold ¯d as the mean distance between observations in only the analysis\nset.\nThese changes aim to limit data leakage between the analysis and assessment data\nsets, ensuring that assessment data is not used to determine parameters for centering and\nscaling analysis data or to calculate ¯d. In practice, this means that waywiser calculates a\nsomewhat higher dk than CAST, which results in a slightly higher DIk and threshold value.\nFor predictions, waywiser scales and centers the entire data set as a whole, and sets ¯d to the\nmean ¯d across folds, under the assumption that the ﬁnal model in use has been retrained"
    },
    {
      "page_no": 22,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "22\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 22,
      "bbox": [
        81.0,
        111.30873107910156,
        200.30194091796875,
        122.21783447265625
      ],
      "text": "using the entire data set."
    },
    {
      "page_no": 22,
      "bbox": [
        236.2100067138672,
        146.5827178955078,
        366.8177185058594,
        160.92892456054688
      ],
      "text": "6. Interoperability"
    },
    {
      "page_no": 22,
      "bbox": [
        81.0,
        172.72988891601562,
        522.1968383789062,
        278.5098876953125
      ],
      "text": "As previous sections have demonstrated, waywiser is designed to be useful for most spatial\nmodeling workﬂows, no matter what models or frameworks are used. Functions in waywiser\nare size- and type-stable, returning outputs of the same data type and predictable dimensions\nregardless of the input arguments used. Functions rely upon well-established data types for\ninputs and outputs, using standard data frames and vectors where appropriate and relying on\nthe popular sf package for spatial data classes. By relying upon standard classes and returning\npredictable outputs, waywiser aims to integrate easily with as many modeling workﬂows as\npossible."
    },
    {
      "page_no": 22,
      "bbox": [
        81.00001525878906,
        284.3579406738281,
        522.1532592773438,
        390.138916015625
      ],
      "text": "However, waywiser is particularly well suited for workﬂows leveraging the tidymodels ecosys-\ntem of modeling packages (Kuhn and Silge 2022).\nThese packages provide a consistent,\nuser-friendly interface for common modeling tasks, with the aim of making it easy for users to\nfollow statistical best practices simply by using package functions in the most straightforward\nway. Functions in waywiser are designed to be automatically compatible with tidymodels\npackages. To demonstrate this, we will ﬁrst split our data into folds for cross-validation,\nusing a 10-fold spatial clustering cross-validation approach, as implemented in spatialsample\n(Mahoney and Silge 2023):"
    },
    {
      "page_no": 22,
      "bbox": [
        81.00003051757812,
        407.90185546875,
        441.8181457519531,
        459.4589538574219
      ],
      "text": "R> library(\"tidymodels\") |>\n+\nsuppressPackageStartupMessages()\nR> (worldclim_resamples <-\n+\nspatialsample::spatial_clustering_cv(worldclim_training))"
    },
    {
      "page_no": 22,
      "bbox": [
        81.00003051757812,
        476.6688537597656,
        281.4547424316406,
        663.718017578125
      ],
      "text": "#\n10-fold spatial cross-validation\n# A tibble: 10 x 2\nsplits\nid\n<list>\n<chr>\n1 <split [7180/820]>\nFold01\n2 <split [7338/662]>\nFold02\n3 <split [6757/1243]> Fold03\n4 <split [7254/746]>\nFold04\n5 <split [6900/1100]> Fold05\n6 <split [7226/774]>\nFold06\n7 <split [7288/712]>\nFold07\n8 <split [7452/548]>\nFold08\n9 <split [7261/739]>\nFold09\n10 <split [7344/656]>\nFold10"
    },
    {
      "page_no": 22,
      "bbox": [
        81.00003051757812,
        680.3748168945312,
        522.1422729492188,
        745.48095703125
      ],
      "text": "Each row of worldclim_resamples contains a single cross-validation iteration, with data\nsplit into analysis and assessment sets based on spatial location; each observation is assigned\nto precisely one assessment set. We can use functions from workﬂows, parsnip, tune, and\nyardstick from the tidymodels ecosystem to then ﬁt separate linear models to each of these\nanalysis sets, and evaluate them against their respective assessment set (Vaughan and Couch"
    },
    {
      "page_no": 23,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n23"
    },
    {
      "page_no": 23,
      "bbox": [
        81.0,
        111.30873107910156,
        522.0466918945312,
        149.31585693359375
      ],
      "text": "2022; Kuhn and Vaughan 2022; Kuhn 2022b; Kuhn et al. 2023). Note that we can easily\nintegrate model assessment functions from waywiser into this workﬂow, as a result of these\nfunctions extending infrastructure from yardstick:"
    },
    {
      "page_no": 23,
      "bbox": [
        81.00003051757812,
        168.31680297851562,
        533.4544677734375,
        233.4229278564453
      ],
      "text": "R> workflow(response ~ bio2 + bio10 + bio13 + bio19) |>\n+\nadd_model(linear_reg()) |>\n+\nfit_resamples(worldclim_resamples,\n+\nmetrics = metric_set(rmse, mae, waywiser::ww_willmott_d1)) |>\n+\ncollect_metrics()"
    },
    {
      "page_no": 23,
      "bbox": [
        81.00003051757812,
        251.86984252929688,
        459.0000305175781,
        330.52496337890625
      ],
      "text": "# A tibble: 3 x 6\n.metric\n.estimator\nmean\nn std_err .config\n<chr>\n<chr>\n<dbl> <int>\n<dbl> <chr>\n1 mae\nstandard\n0.0968\n10 0.00875 Preprocessor1_Model1\n2 rmse\nstandard\n0.120\n10 0.0106\nPreprocessor1_Model1\n3 willmott_d1 standard\n0.642\n10 0.0465\nPreprocessor1_Model1"
    },
    {
      "page_no": 23,
      "bbox": [
        81.00003051757812,
        348.3929748535156,
        522.0582885742188,
        386.42694091796875
      ],
      "text": "We can similarly use model assessment functions from waywiser for other purposes, for in-\nstance to automatically evaluate hyperparameters for a random forest model using the dials\npackage (Kuhn and Frick 2022):"
    },
    {
      "page_no": 23,
      "bbox": [
        81.00003051757812,
        405.4278869628906,
        481.90899658203125,
        538.279052734375
      ],
      "text": "R> rf_workflow <- workflow(response ~ bio2 + bio10 + bio13 + bio19) |>\n+\nadd_model(rand_forest(\"regression\", mtry = tune(),\n+\ntrees = tune(), min_n = tune()))\nR> rf_parameters <- extract_parameter_set_dials(rf_workflow) |>\n+\nfinalize(worldclim_resamples)\nR> rf_res <- rf_workflow |>\n+\ntune_grid(grid = grid_latin_hypercube(rf_parameters, size = 9),\n+\nresamples = worldclim_resamples,\n+\nmetrics = metric_set(waywiser::ww_willmott_d1))\nR> collect_metrics(rf_res)"
    },
    {
      "page_no": 23,
      "bbox": [
        81.00003051757812,
        556.7269897460938,
        539.181884765625,
        716.677001953125
      ],
      "text": "# A tibble: 9 x 9\nmtry trees min_n .metric\n.estimator\nmean\nn std_err .config\n<int> <int> <int> <chr>\n<chr>\n<dbl> <int>\n<dbl> <chr>\n1\n2\n971\n32 willmott_d1 standard\n0.935\n10 0.0102\nPreprocessor1_Mo~\n2\n1\n325\n17 willmott_d1 standard\n0.916\n10 0.0129\nPreprocessor1_Mo~\n3\n2\n482\n7 willmott_d1 standard\n0.945\n10 0.00945 Preprocessor1_Mo~\n4\n2\n95\n26 willmott_d1 standard\n0.936\n10 0.0101\nPreprocessor1_Mo~\n5\n1\n1657\n29 willmott_d1 standard\n0.910\n10 0.0144\nPreprocessor1_Mo~\n6\n1\n1522\n5 willmott_d1 standard\n0.926\n10 0.0123\nPreprocessor1_Mo~\n7\n2\n728\n23 willmott_d1 standard\n0.938\n10 0.00985 Preprocessor1_Mo~\n8\n1\n1779\n36 willmott_d1 standard\n0.907\n10 0.0143\nPreprocessor1_Mo~\n9\n2\n1134\n14 willmott_d1 standard\n0.942\n10 0.00954 Preprocessor1_Mo~"
    },
    {
      "page_no": 23,
      "bbox": [
        81.00003051757812,
        735.125,
        207.00018310546875,
        746.0340576171875
      ],
      "text": "R> select_best(rf_res)"
    },
    {
      "page_no": 24,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "24\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 24,
      "bbox": [
        81.0,
        111.86178588867188,
        310.09100341796875,
        163.4179229736328
      ],
      "text": "# A tibble: 1 x 4\nmtry trees min_n .config\n<int> <int> <int> <chr>\n1\n2\n482\n7 Preprocessor1_Model3"
    },
    {
      "page_no": 24,
      "bbox": [
        80.99996948242188,
        181.31275939941406,
        522.2078247070312,
        219.31988525390625
      ],
      "text": "Having found the optimal hyperparameters for the random forest, we can then ﬁt our tuned\nmodel to our full set of training data and use functions from yardstick and waywiser to\nevaluate predictions against the test set:"
    },
    {
      "page_no": 24,
      "bbox": [
        80.99996948242188,
        238.32083129882812,
        464.72723388671875,
        344.073974609375
      ],
      "text": "R> tuned_rf_workflow <- rf_workflow |>\n+\nfinalize_workflow(select_best(rf_res)) |>\n+\nfit(worldclim_training)\nR> worldclim_testing$predictions <- predict(tuned_rf_workflow,\n+\nworldclim_testing)$.pred\nR> metrics <- metric_set(waywiser::ww_willmott_d1,\n+\nwaywiser::ww_agreement_coefficient)\nR> metrics(worldclim_testing, response, predictions)"
    },
    {
      "page_no": 24,
      "bbox": [
        80.99996948242188,
        362.5218811035156,
        333.0005798339844,
        427.62799072265625
      ],
      "text": "# A tibble: 2 x 3\n.metric\n.estimator .estimate\n<chr>\n<chr>\n<dbl>\n1 willmott_d1\nstandard\n0.983\n2 agreement_coefficient standard\n0.998"
    },
    {
      "page_no": 24,
      "bbox": [
        80.99996948242188,
        445.5218505859375,
        522.131103515625,
        484.0829772949219
      ],
      "text": "Finally, as alluded to in Section 5, we may also use ww_area_of_applicability() with our\ncross-validation object to estimate the AOA of this random forest. In order to do so, we will\nﬁrst estimate our variable importance scores through vip::vi_permute():"
    },
    {
      "page_no": 24,
      "bbox": [
        80.99996948242188,
        502.5298767089844,
        407.4544982910156,
        703.1279907226562
      ],
      "text": "R> d1_wrapper <- function(actual, predicted) {\n+\nwaywiser::ww_willmott_d1_vec(actual, predicted)\n+ }\nR> pred_wrapper <- function(object, newdata) {\n+\nobject |>\n+\npredict(newdata) |>\n+\nranger::predictions()\n+ }\nR> importance <- vip::vi_permute(\n+\nextract_fit_engine(tuned_rf_workflow),\n+\ntrain = as.data.frame(worldclim_training)[c(1:4, 6)],\n+\ntarget = \"response\",\n+\nmetric = d1_wrapper,\n+\nsmaller_is_better = FALSE,\n+\npred_wrapper = pred_wrapper)"
    },
    {
      "page_no": 24,
      "bbox": [
        80.99996948242188,
        721.0228271484375,
        522.1967163085938,
        746.0339965820312
      ],
      "text": "We are then able to calculate our area of applicability by passing our cross-validation object,\nmodel formula, and importance scores to ww_area_of_applicability():"
    },
    {
      "page_no": 25,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n25"
    },
    {
      "page_no": 25,
      "bbox": [
        81.0,
        111.86178588867188,
        333.0000915527344,
        163.4179229736328
      ],
      "text": "R> waywiser::ww_area_of_applicability(\n+\nworldclim_resamples,\n+\nresponse ~ bio2 + bio10 + bio13 + bio19,\n+\nimportance = importance)"
    },
    {
      "page_no": 25,
      "bbox": [
        81.0,
        181.97982788085938,
        264.2729187011719,
        233.5359649658203
      ],
      "text": "# Predictors:\n4\nArea-of-applicability threshold:\n0.1791143"
    },
    {
      "page_no": 25,
      "bbox": [
        81.0,
        251.51693725585938,
        522.1968994140625,
        343.7489013671875
      ],
      "text": "In this way, waywiser functions are designed to integrate naturally with packages in the\ntidymodels ecosystem, extending the consistent user-friendly interfaces of those packages for\nspatial model assessment tasks. However, as emphasized at the start of this section, waywiser\nfunctions are designed to be framework-agnostic and also accept standard data frames and\nvectors as inputs, while returning standard data frames and vectors as outputs wherever\npossible. In this way, waywiser aims to be maximally interoperable with as many modeling\nworkﬂows as possible."
    },
    {
      "page_no": 25,
      "bbox": [
        253.0170135498047,
        368.4728088378906,
        349.9972839355469,
        382.8190002441406
      ],
      "text": "7. Conclusion"
    },
    {
      "page_no": 25,
      "bbox": [
        80.99998474121094,
        394.7889709472656,
        522.218505859375,
        555.3190307617188
      ],
      "text": "The waywiser package provides an ergonomic toolkit for assessing spatial models, with a focus\non providing a consistent interface to multiple well-established assessment methods. Func-\ntions provided by waywiser include a number of model assessment metrics, an approach for\nassessing model performance when aggregating predictions across multiple spatial scales, and\nan approach for calculating the applicability domain of a model. These functions accept and,\nwhere possible, return values as standard data frames and vectors, making them compatible\nwith a wide swath of modeling workﬂows. Additional features make it particularly easy to\nuse waywiser in combination with packages from the tidymodels ecosystem. Future direc-\ntions for the package will include the addition of new assessment metrics and computational\nspeedups.\nRelease versions of waywiser are available from the Comprehensive R Archive\nNetwork (CRAN) at https://CRAN.R-project.org/package=waywiser, while development\nversions may be downloaded from GitHub at https://github.com/ropensci/waywiser."
    },
    {
      "page_no": 25,
      "bbox": [
        238.45797729492188,
        579.4898681640625,
        364.5896911621094,
        593.8360595703125
      ],
      "text": "Acknowledgments"
    },
    {
      "page_no": 25,
      "bbox": [
        80.99998474121094,
        605.8060913085938,
        522.207763671875,
        657.3899536132812
      ],
      "text": "Initial development of waywiser was supported by Posit, PBC. Version 0.3.0 of waywiser was\nreviewed for rOpenSci by Dr. Virgilio Gómez-Rubio and Dr. Jakub Nowosad, whose feedback\ngreatly improved the package.\nLucas Johnson provided valuable feedback on the area of\napplicability implementation and the multi-scale assessment workﬂow."
    },
    {
      "page_no": 25,
      "bbox": [
        263.73699951171875,
        682.1138305664062,
        339.2553405761719,
        696.4600219726562
      ],
      "text": "References"
    },
    {
      "page_no": 25,
      "bbox": [
        81.0,
        721.0228271484375,
        522.0027465820312,
        746.0339965820312
      ],
      "text": "Anselin L (1995). “Local Indicators of Spatial Association-LISA.” Geographical Analysis,\n27(2), 93–115. doi:10.1111/j.1538-4632.1995.tb00338.x."
    },
    {
      "page_no": 26,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "26\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 26,
      "bbox": [
        81.0,
        111.30873107910156,
        522.1530151367188,
        136.3199005126953
      ],
      "text": "Anselin L (2018). “A Local Indicator of Multivariate Spatial Association: Extending Geary’s\nc.” Geographical Analysis, 51(2), 133–150. doi:10.1111/gean.12164."
    },
    {
      "page_no": 26,
      "bbox": [
        81.0,
        148.08473205566406,
        522.0037231445312,
        173.0959014892578
      ],
      "text": "Baston D (2022). exactextractr: Fast Extraction from Raster Datasets using Polygons. R\npackage version 0.9.1, URL https://CRAN.R-project.org/package=exactextractr."
    },
    {
      "page_no": 26,
      "bbox": [
        81.0,
        184.8617706298828,
        522.1204223632812,
        209.87294006347656
      ],
      "text": "Bivand R (2022). “R Packages for Analyzing Spatial Data: A Comparative Case Study with\nAreal Data.” Geographical Analysis, 54(3), 488–518. doi:10.1111/gean.12319."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99993896484375,
        221.6377716064453,
        522.0026245117188,
        246.64894104003906
      ],
      "text": "Bivand RS, Pebesma EJ, Gómez-Rubio V (2008).\nApplied Spatial Data Analysis with R.\nSpringer New York, New York. doi:10.1007/978-0-387-78171-6."
    },
    {
      "page_no": 26,
      "bbox": [
        80.9998779296875,
        258.4137878417969,
        522.131103515625,
        283.4259033203125
      ],
      "text": "Bivand RS, Wong DWS (2018). “Comparing Implementations of Global and Local Indicators\nof Spatial Association.” TEST, 27(3), 716–748. doi:10.1007/s11749-018-0599-x."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99990844726562,
        295.1907653808594,
        522.1528930664062,
        347.2999267578125
      ],
      "text": "Blackard J, Finco M, Helmer E, Holden G, Hoppus M, Jacobs D, Lister A, Moisen G, Nelson\nM, Riemann R (2008). “Mapping U.S. Forest Biomass Using Nationwide Forest Inventory\nData and Moderate Resolution Information.” Remote Sensing of Environment, 112(4),\n1658–1677. doi:10.1016/j.rse.2007.08.021."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99984741210938,
        359.0657958984375,
        522.1091918945312,
        397.6259460449219
      ],
      "text": "Correndo AA, Moro Rosso LH, Schwalbert R, Hernandez C, Bastos LM, Nieto L, Holzworth\nD, Ciampitti IA (2022). metrica: Prediction Performance Metrics. R package version 2.0.1,\nURL https://CRAN.R-project.org/package=metrica."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99984741210938,
        409.39080810546875,
        522.1856689453125,
        447.9519348144531
      ],
      "text": "Draper NR, Yang Y (1997). “Generalization of the Geometric Mean Functional Relationship.”\nComputational Statistics & Data Analysis, 23(3), 355–372. doi:10.1016/s0167-9473(96)\n00037-0."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99984741210938,
        459.716796875,
        522.1091918945312,
        498.2769470214844
      ],
      "text": "Fick SE, Hijmans RJ (2017). “WorldClim 2: New 1-km Spatial Resolution Climate Surfaces\nfor Global Land Areas.” International Journal of Climatology, 37(12), 4302–4315. doi:\n10.1002/joc.5086."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99984741210938,
        510.0417785644531,
        522.0209350585938,
        548.6029052734375
      ],
      "text": "Frick H, Chow F, Kuhn M, Mahoney M, Silge J, Wickham H (2022).\nrsample: General\nResampling Infrastructure. R package version 1.1.1, URL https://CRAN.R-project.org/\npackage=rsample."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99983978271484,
        560.3677978515625,
        522.0050659179688,
        585.37890625
      ],
      "text": "Geary RC (1954). “The Contiguity Ratio and Statistical Mapping.” The Incorporated Statis-\ntician, 5(3), 115. doi:10.2307/2986645."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99989318847656,
        597.143798828125,
        522.1094360351562,
        622.1559448242188
      ],
      "text": "Getis A, Ord JK (1992). “The Analysis of Spatial Association by Use of Distance Statistics.”\nGeographical Analysis, 24(3), 189–206. doi:10.1111/j.1538-4632.1992.tb00261.x."
    },
    {
      "page_no": 26,
      "bbox": [
        80.9998779296875,
        633.9207763671875,
        522.1529541015625,
        671.9279174804688
      ],
      "text": "Getis A, Ord JK (1996). Spatial Analysis: Modelling in a GIS Environment, chapter Local\nSpatial Statistics: An Overview, pp. 261–277. GeoInformation International, Cambridge,\nUK."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99990844726562,
        684.2457885742188,
        522.0037841796875,
        709.2579345703125
      ],
      "text": "Gotti M, Kuhn M (2022). applicable: A Compilation of Applicability Domain Methods. R\npackage version 0.1.0, URL https://CRAN.R-project.org/package=applicable."
    },
    {
      "page_no": 26,
      "bbox": [
        80.99993896484375,
        721.0227661132812,
        522.1422729492188,
        746.033935546875
      ],
      "text": "Greenwell BM, Boehmke BC (2020). “Variable Importance Plots — An Introduction to the\nvip Package.” The R Journal, 12(1), 343–366. doi:10.32614/RJ-2020-013."
    },
    {
      "page_no": 27,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n27"
    },
    {
      "page_no": 27,
      "bbox": [
        81.0,
        111.30873107910156,
        470.6687316894531,
        122.21783447265625
      ],
      "text": "Guerry AM (1833). Essai sur la statistique morale de la France. Crochard, Paris."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00003051757812,
        133.3257598876953,
        521.9996337890625,
        158.33790588378906
      ],
      "text": "Hijmans RJ (2023). terra: Spatial Data Analysis. R package version 1.7-3, URL https:\n//CRAN.R-project.org/package=terra."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00003051757812,
        168.8927764892578,
        522.0048217773438,
        193.90394592285156
      ],
      "text": "Ji L, Gallo K (2006). “An Agreement Coeﬃcient for Image Comparison.” Photogrammetric\nEngineering & Remote Sensing, 72(7), 823–833. doi:10.14358/pers.72.7.823."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00006103515625,
        204.4597930908203,
        522.1532592773438,
        256.5689697265625
      ],
      "text": "Johnson LK, Mahoney MJ, Bevilacqua E, Stehman SV, Domke GM, Beier CM (2022). “Fine-\nResolution Landscape-Scale Biomass Mapping Using a Spatiotemporal Patchwork of Li-\nDAR Coverages.” International Journal of Applied Earth Observation and Geoinformation,\n114, 103059. doi:10.1016/j.jag.2022.103059."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        267.1248474121094,
        522.039306640625,
        292.135986328125
      ],
      "text": "Kuhn M (2022a). caret: Classiﬁcation and Regression Training. R package version 6.0-93,\nURL https://CRAN.R-project.org/package=caret."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        302.6908874511719,
        522.0005493164062,
        327.7020263671875
      ],
      "text": "Kuhn M (2022b). tune: Tidy Tuning Tools. R package version 1.0.1, URL https://CRAN.\nR-project.org/package=tune."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        338.2579040527344,
        522.0220336914062,
        363.26904296875
      ],
      "text": "Kuhn M, Frick H (2022). dials: Tools for Creating Tuning Parameter Values. R package\nversion 1.1.0, URL https://CRAN.R-project.org/package=dials."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        373.8249206542969,
        435.54425048828125,
        384.7340087890625
      ],
      "text": "Kuhn M, Silge J (2022). Tidy Modeling with R. O’Reilly, Sebastopol, CA."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00007629394531,
        395.8419189453125,
        522.0028076171875,
        420.8530578613281
      ],
      "text": "Kuhn M, Vaughan D (2022). parsnip: A Common API to Modeling and Analysis Functions.\nR package version 1.0.3, URL https://CRAN.R-project.org/package=parsnip."
    },
    {
      "page_no": 27,
      "bbox": [
        81.0001220703125,
        431.408935546875,
        522.0402221679688,
        469.9690856933594
      ],
      "text": "Kuhn M, Vaughan D, Hvitfeldt E (2023).\nyardstick:\nTidy Characterizations of Model\nPerformance.\nR package version 1.2.0, URL https://CRAN.R-project.org/package=\nyardstick."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        480.5239562988281,
        522.1204833984375,
        519.0850830078125
      ],
      "text": "Legates DR, McCabe GJ (1999).\n“Evaluating the Use of “Goodness-of-Fit” Measures in\nHydrologic and Hydroclimatic Model Validation.” Water Resources Research, 35(1), 233–\n241. doi:10.1029/1998wr900018."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00007629394531,
        529.6130981445312,
        522.004638671875,
        554.651123046875
      ],
      "text": "Legendre P, Fortin M (1989). “Spatial Pattern and Ecological Analysis.” Vegetatio, 80(2),\n107–138. doi:10.1007/bf00048036."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        565.2069091796875,
        522.1314697265625,
        590.2180786132812
      ],
      "text": "Leroy B, Meynard CN, Bellard C, Courchamp F (2015). “virtualspecies, an R Package to\nGenerate Virtual Species Distributions.” Ecography. doi:10.1111/ecog.01388."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        600.77392578125,
        522.035888671875,
        625.7850952148438
      ],
      "text": "Li X, Anselin L (2023). rgeoda: R Library for Spatial Data Analysis. R package version\n0.0.10-2, URL https://CRAN.R-project.org/package=rgeoda."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        636.3399658203125,
        522.0240478515625,
        661.35107421875
      ],
      "text": "Mahoney M, Silge J (2023). spatialsample: Spatial Resampling Infrastructure. R package\nversion 0.3.0, URL https://CRAN.R-project.org/package=spatialsample."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        671.9069213867188,
        522.0028076171875,
        696.9180908203125
      ],
      "text": "Meyer H, Milà C, Ludwig M (2023). CAST: ’caret’ Applications for Spatial-Temporal Models.\nR package version 0.7.1, URL https://CRAN.R-project.org/package=CAST."
    },
    {
      "page_no": 27,
      "bbox": [
        81.00009155273438,
        707.472900390625,
        522.1641235351562,
        746.0340576171875
      ],
      "text": "Meyer H, Pebesma E (2021).\n“Predicting into Unknown Space?\nEstimating the Area of\nApplicability of Spatial Prediction Models.”\nMethods in Ecology and Evolution, 12(9),\n1620–1633. doi:10.1111/2041-210x.13650."
    },
    {
      "page_no": 28,
      "bbox": [
        81.0,
        75.4158706665039,
        455.93353271484375,
        86.351806640625
      ],
      "text": "28\nwaywiser: Ergonomic Methods for Assessing Spatial Models"
    },
    {
      "page_no": 28,
      "bbox": [
        81.0,
        111.28189849853516,
        522.0108642578125,
        122.21783447265625
      ],
      "text": "Moran PAP (1950). “Notes on Continuous Stochastic Phenomena.” Biometrika, 37(1/2), 17."
    },
    {
      "page_no": 28,
      "bbox": [
        91.90899658203125,
        124.85774230957031,
        203.7597198486328,
        136.3199005126953
      ],
      "text": "doi:10.2307/2332142."
    },
    {
      "page_no": 28,
      "bbox": [
        80.99999237060547,
        147.89173889160156,
        522.0343627929688,
        158.80084228515625
      ],
      "text": "Müller K, Wickham H (2022). tibble: Simple Data Frames. R package version 3.1.8, URL"
    },
    {
      "page_no": 28,
      "bbox": [
        91.90896606445312,
        161.4407501220703,
        330.2576904296875,
        172.9029083251953
      ],
      "text": "https://CRAN.R-project.org/package=tibble."
    },
    {
      "page_no": 28,
      "bbox": [
        80.99996948242188,
        184.47474670410156,
        522.1422729492188,
        223.03492736816406
      ],
      "text": "Nelson MD, McRoberts RE, Holden GR, Bauer ME (2009). “Eﬀects of Satellite Image Spatial\nAggregation and Resolution on Estimates of Forest Land Area.” International Journal of\nRemote Sensing, 30(8), 1913–1940. doi:10.1080/01431160802545631."
    },
    {
      "page_no": 28,
      "bbox": [
        80.99996948242188,
        234.6067657470703,
        522.1857299804688,
        313.81494140625
      ],
      "text": "Netzeva TI, Worth AP, Aldenberg T, Benigni R, Cronin MT, Gramatica P, Jaworska JS, Kahn\nS, Klopman G, Marchant CA, Myatt G, Nikolova-Jeliazkova N, Patlewicz GY, Perkins\nR, Roberts DW, Schultz TW, Stanton DT, van de Sandt JJ, Tong W, Veith G, Yang C\n(2005). “Current Status of Methods for Deﬁning the Applicability Domain of (Quantitative)\nStructure-Activity Relationships.”\nAlternatives to Laboratory Animals, 33(2), 155–173.\ndoi:10.1177/026119290503300209."
    },
    {
      "page_no": 28,
      "bbox": [
        80.99998474121094,
        325.38580322265625,
        522.120361328125,
        363.9469299316406
      ],
      "text": "Ord JK, Getis A (1995).\n“Local Spatial Autocorrelation Statistics: Distributional Issues\nand an Application.” Geographical Analysis, 27(4), 286–306. doi:10.1111/j.1538-4632.\n1995.tb00912.x."
    },
    {
      "page_no": 28,
      "bbox": [
        81.00003051757812,
        375.5177917480469,
        522.18603515625,
        400.5289306640625
      ],
      "text": "Pebesma E (2018). “Simple Features for R: Standardized Support for Spatial Vector Data.”\nThe R Journal, 10(1), 439–446. doi:10.32614/RJ-2018-009."
    },
    {
      "page_no": 28,
      "bbox": [
        81.0,
        412.1007995605469,
        522.0435180664062,
        437.1119384765625
      ],
      "text": "Pedersen TL (2022).\npatchwork: The Composer of Plots.\nR package version 1.1.2, URL\nhttps://CRAN.R-project.org/package=patchwork."
    },
    {
      "page_no": 28,
      "bbox": [
        81.0,
        448.6838073730469,
        522.1857299804688,
        487.24395751953125
      ],
      "text": "Reich Y, Barai S (1999). “Evaluating Machine Learning Models for Engineering Problems.”\nArtiﬁcial Intelligence in Engineering, 13(3), 257–272.\ndoi:10.1016/s0954-1810(98)\n00021-1."
    },
    {
      "page_no": 28,
      "bbox": [
        81.0,
        498.8158264160156,
        522.1204223632812,
        550.9249877929688
      ],
      "text": "Riemann R, Wilson BT, Lister A, Parks S (2010). “An Eﬀective Assessment Protocol for\nContinuous Geospatial Datasets of Forest Characteristics Using USFS Forest Inventory\nand Analysis (FIA) Data.” Remote Sensing of Environment, 114(10), 2337–2352. doi:\n10.1016/j.rse.2010.05.010."
    },
    {
      "page_no": 28,
      "bbox": [
        80.99996948242188,
        562.496826171875,
        522.0986938476562,
        614.6069946289062
      ],
      "text": "Roehm T, Tiarks R, Koschke R, Maalej W (2012).\n“How do Professional Developers\nComprehend Software?”\n2012 34th International Conference on Software Engineering\n(ICSE).\ndoi:10.1109/icse.2012.6227188.\nURL http://dx.doi.org/10.1109/ICSE.\n2012.6227188."
    },
    {
      "page_no": 28,
      "bbox": [
        80.99995422363281,
        626.1778564453125,
        522.1966552734375,
        745.48095703125
      ],
      "text": "van den Hoogen J, Geisen S, Routh D, Ferris H, Traunspurger W, Wardle DA, de Goede\nRGM, Adams BJ, Ahmad W, Andriuzzi WS, Bardgett RD, Bonkowski M, Campos-Herrera\nR, Cares JE, Caruso T, de Brito Caixeta L, Chen X, Costa SR, Creamer R, Mauro da\nCunha Castro J, Dam M, Djigal D, Escuer M, Griﬃths BS, Gutiérrez C, Hohberg K,\nKalinkina D, Kardol P, Kergunteuil A, Korthals G, Krashevska V, Kudrin AA, Li Q, Liang\nW, Magilton M, Marais M, Martín J, Matveeva E, Mayad EH, Mulder C, Mullin P, Neilson\nR, Nguyen TAD, Nielsen UN, Okada H, Rius JEP, Pan K, Peneva V, Pellissier L, Carlos\nPereira da Silva J, Pitteloud C, Powers TO, Powers K, Quist CW, Rasmann S, Moreno\nS, Scheu S, Setälä H, Sushchuk A, Tiunov AV, Trap J, van der Putten W, Vestergård M,"
    },
    {
      "page_no": 29,
      "bbox": [
        254.7570037841797,
        75.44270324707031,
        532.9090576171875,
        86.351806640625
      ],
      "text": "Michael J Mahoney\n29"
    },
    {
      "page_no": 29,
      "bbox": [
        91.90899658203125,
        111.30873107910156,
        522.1638793945312,
        149.86891174316406
      ],
      "text": "Villenave C, Waeyenberge L, Wall DH, Wilschut R, Wright DG, Yang Ji, Crowther TW\n(2019). “Soil Nematode Abundance and Functional Group Composition at a Global Scale.”\nNature, 572(7768), 194–198. doi:10.1038/s41586-019-1418-6."
    },
    {
      "page_no": 29,
      "bbox": [
        81.0,
        160.1387481689453,
        522.0386962890625,
        171.0478515625
      ],
      "text": "Vaughan D, Couch S (2022). workﬂows: Modeling Workﬂows. R package version 1.1.2, URL"
    },
    {
      "page_no": 29,
      "bbox": [
        91.90896606445312,
        173.68775939941406,
        347.43865966796875,
        185.14991760253906
      ],
      "text": "https://CRAN.R-project.org/package=workflows."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99993896484375,
        195.4197540283203,
        522.0489501953125,
        220.43190002441406
      ],
      "text": "Wickham H (2016). ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York.\nISBN 978-3-319-24277-4. URL https://ggplot2.tidyverse.org."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99990844726562,
        230.7017364501953,
        522.0216064453125,
        269.26190185546875
      ],
      "text": "Wickham H, François R, Henry L, Müller K, Vaughan D (2023a). dplyr: A Grammar of Data\nManipulation.\nR package version 1.1.0, URL https://CRAN.R-project.org/package=\ndplyr."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99990844726562,
        279.5317687988281,
        522.0292358398438,
        304.54290771484375
      ],
      "text": "Wickham H, Vaughan D, Girlich M (2023b). tidyr: Tidy Messy Data. R package version\n1.3.0, URL https://CRAN.R-project.org/package=tidyr."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99990844726562,
        314.7859191894531,
        522.0086059570312,
        325.72186279296875
      ],
      "text": "Willmott CJ (1981). “On the Validation of Models.” Physical Geography, 2(2), 184–194."
    },
    {
      "page_no": 29,
      "bbox": [
        91.90887451171875,
        328.3617858886719,
        289.6685791015625,
        339.82391357421875
      ],
      "text": "doi:10.1080/02723646.1981.10642213."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99986267089844,
        350.0937805175781,
        522.0174560546875,
        388.6549072265625
      ],
      "text": "Willmott CJ (1982). “Some Comments on the Evaluation of Model Performance.” Bulletin of\nthe American Meteorological Society, 63(11), 1309–1313. doi:10.1175/1520-0477(1982)\n063<1309:scoteo>2.0.co;2."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99990844726562,
        398.9247741699219,
        522.131103515625,
        437.48492431640625
      ],
      "text": "Willmott CJ, Ackleson SG, Davis RE, Feddema JJ, Klink KM, Legates DR, O’Donnell J,\nRowe CM (1985). “Statistics for the Evaluation and Comparison of Models.” Journal of\nGeophysical Research, 90(C5), 8995. doi:10.1029/jc090ic05p08995."
    },
    {
      "page_no": 29,
      "bbox": [
        80.9998779296875,
        447.7547912597656,
        522.153076171875,
        472.76593017578125
      ],
      "text": "Willmott CJ, Robeson SM, Matsuura K (2011). “A Reﬁned Index of Model Performance.”\nInternational Journal of Climatology, 32(13), 2088–2094. doi:10.1002/joc.2419."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99990844726562,
        483.0357971191406,
        522.1530151367188,
        521.596923828125
      ],
      "text": "Willmott CJ, Wicks DE (1980).\n“An Empirical Method for the Spatial Interpolation of\nMonthly Precipitation Within California.” Physical Geography, 1(1), 59–73. doi:10.1080/\n02723646.1980.10642189."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99993896484375,
        531.8667602539062,
        522.059326171875,
        570.4269409179688
      ],
      "text": "Zambrano-Bigiarini M (2020). hydroGOF: Goodness-of-Fit Functions for Comparison of Sim-\nulated and Observed Hydrological Time Series. doi:10.5281/zenodo.839854. R package\nversion 0.4-0, URL https://github.com/hzambran/hydroGOF."
    },
    {
      "page_no": 29,
      "bbox": [
        80.99996948242188,
        607.7625122070312,
        143.32244873046875,
        619.7177124023438
      ],
      "text": "Aﬃliation:"
    },
    {
      "page_no": 29,
      "bbox": [
        80.99996948242188,
        626.1777954101562,
        448.7021789550781,
        718.9349365234375
      ],
      "text": "Michael J Mahoney\nState University of New York College of Environmental Science and Forestry\nGraduate Program in Environmental Science\n1 Forestry Drive\nSyracuse, NY, USA\nE-mail: mjmahone@esf.edu\nURL: https://mm218.dev/"
    }
  ],
  "pictures": [
    {
      "page_no": 13,
      "bbox": [
        445.73968505859375,
        147.99850463867188,
        456.8651123046875,
        203.62564086914062
      ],
      "xref": 2,
      "image_path": "../data/parsed_documents/2303.11312/images/2303.11312_p13_blk1_crop.png"
    },
    {
      "page_no": 13,
      "bbox": [
        443.48919677734375,
        295.6494140625,
        454.6146240234375,
        351.27655029296875
      ],
      "xref": 9,
      "image_path": "../data/parsed_documents/2303.11312/images/2303.11312_p13_blk2_crop.png"
    },
    {
      "page_no": 17,
      "bbox": [
        417.75189208984375,
        146.48617553710938,
        426.5055847167969,
        190.254638671875
      ],
      "xref": 2,
      "image_path": "../data/parsed_documents/2303.11312/images/2303.11312_p17_blk1_crop.png"
    },
    {
      "page_no": 21,
      "bbox": [
        445.24774169921875,
        147.44715881347656,
        456.2160339355469,
        202.28857421875
      ],
      "xref": 2,
      "image_path": "../data/parsed_documents/2303.11312/images/2303.11312_p21_blk1_crop.png"
    }
  ],
  "tables": [
    {
      "page_no": 1,
      "index": 1,
      "flavor": "stream",
      "nrows": 18,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p1_table1_stream.csv"
    },
    {
      "page_no": 1,
      "index": 2,
      "flavor": "stream",
      "nrows": 14,
      "ncols": 2,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p1_table2_stream.csv"
    },
    {
      "page_no": 2,
      "index": 1,
      "flavor": "stream",
      "nrows": 42,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p2_table1_stream.csv"
    },
    {
      "page_no": 3,
      "index": 1,
      "flavor": "stream",
      "nrows": 25,
      "ncols": 2,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p3_table1_stream.csv"
    },
    {
      "page_no": 4,
      "index": 1,
      "flavor": "stream",
      "nrows": 19,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p4_table1_stream.csv"
    },
    {
      "page_no": 5,
      "index": 1,
      "flavor": "stream",
      "nrows": 17,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p5_table1_stream.csv"
    },
    {
      "page_no": 6,
      "index": 1,
      "flavor": "stream",
      "nrows": 48,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p6_table1_stream.csv"
    },
    {
      "page_no": 7,
      "index": 1,
      "flavor": "stream",
      "nrows": 37,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p7_table1_stream.csv"
    },
    {
      "page_no": 8,
      "index": 1,
      "flavor": "stream",
      "nrows": 11,
      "ncols": 2,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p8_table1_stream.csv"
    },
    {
      "page_no": 8,
      "index": 2,
      "flavor": "stream",
      "nrows": 19,
      "ncols": 5,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p8_table2_stream.csv"
    },
    {
      "page_no": 9,
      "index": 1,
      "flavor": "stream",
      "nrows": 16,
      "ncols": 2,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p9_table1_stream.csv"
    },
    {
      "page_no": 10,
      "index": 1,
      "flavor": "stream",
      "nrows": 33,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p10_table1_stream.csv"
    },
    {
      "page_no": 11,
      "index": 1,
      "flavor": "stream",
      "nrows": 68,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p11_table1_stream.csv"
    },
    {
      "page_no": 12,
      "index": 1,
      "flavor": "stream",
      "nrows": 39,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p12_table1_stream.csv"
    },
    {
      "page_no": 13,
      "index": 1,
      "flavor": "stream",
      "nrows": 32,
      "ncols": 7,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p13_table1_stream.csv"
    },
    {
      "page_no": 14,
      "index": 1,
      "flavor": "stream",
      "nrows": 11,
      "ncols": 11,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p14_table1_stream.csv"
    },
    {
      "page_no": 14,
      "index": 2,
      "flavor": "stream",
      "nrows": 17,
      "ncols": 11,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p14_table2_stream.csv"
    },
    {
      "page_no": 15,
      "index": 1,
      "flavor": "stream",
      "nrows": 8,
      "ncols": 2,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p15_table1_stream.csv"
    },
    {
      "page_no": 15,
      "index": 2,
      "flavor": "stream",
      "nrows": 10,
      "ncols": 4,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p15_table2_stream.csv"
    },
    {
      "page_no": 15,
      "index": 3,
      "flavor": "stream",
      "nrows": 10,
      "ncols": 10,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p15_table3_stream.csv"
    },
    {
      "page_no": 16,
      "index": 1,
      "flavor": "stream",
      "nrows": 11,
      "ncols": 8,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p16_table1_stream.csv"
    },
    {
      "page_no": 16,
      "index": 2,
      "flavor": "stream",
      "nrows": 14,
      "ncols": 3,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p16_table2_stream.csv"
    },
    {
      "page_no": 17,
      "index": 1,
      "flavor": "lattice",
      "nrows": 10,
      "ncols": 10,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p17_table1_lattice.csv"
    },
    {
      "page_no": 18,
      "index": 1,
      "flavor": "stream",
      "nrows": 20,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p18_table1_stream.csv"
    },
    {
      "page_no": 19,
      "index": 1,
      "flavor": "stream",
      "nrows": 45,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p19_table1_stream.csv"
    },
    {
      "page_no": 20,
      "index": 1,
      "flavor": "stream",
      "nrows": 15,
      "ncols": 8,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p20_table1_stream.csv"
    },
    {
      "page_no": 20,
      "index": 2,
      "flavor": "stream",
      "nrows": 14,
      "ncols": 2,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p20_table2_stream.csv"
    },
    {
      "page_no": 21,
      "index": 1,
      "flavor": "stream",
      "nrows": 5,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p21_table1_stream.csv"
    },
    {
      "page_no": 22,
      "index": 1,
      "flavor": "stream",
      "nrows": 18,
      "ncols": 2,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p22_table1_stream.csv"
    },
    {
      "page_no": 22,
      "index": 2,
      "flavor": "stream",
      "nrows": 14,
      "ncols": 2,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p22_table2_stream.csv"
    },
    {
      "page_no": 23,
      "index": 1,
      "flavor": "stream",
      "nrows": 9,
      "ncols": 7,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p23_table1_stream.csv"
    },
    {
      "page_no": 23,
      "index": 2,
      "flavor": "stream",
      "nrows": 14,
      "ncols": 10,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p23_table2_stream.csv"
    },
    {
      "page_no": 24,
      "index": 1,
      "flavor": "stream",
      "nrows": 41,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p24_table1_stream.csv"
    },
    {
      "page_no": 25,
      "index": 1,
      "flavor": "stream",
      "nrows": 10,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p25_table1_stream.csv"
    },
    {
      "page_no": 26,
      "index": 1,
      "flavor": "stream",
      "nrows": 38,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p26_table1_stream.csv"
    },
    {
      "page_no": 27,
      "index": 1,
      "flavor": "stream",
      "nrows": 15,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p27_table1_stream.csv"
    },
    {
      "page_no": 28,
      "index": 1,
      "flavor": "stream",
      "nrows": 41,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p28_table1_stream.csv"
    },
    {
      "page_no": 29,
      "index": 1,
      "flavor": "stream",
      "nrows": 29,
      "ncols": 1,
      "csv_path": "../data/parsed_documents/2303.11312/2303.11312_p29_table1_stream.csv"
    }
  ]
}